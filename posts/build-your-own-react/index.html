<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/blog/styles.3835909323283a286c5c.css" id="gatsby-global-css">html{scroll-behavior:smooth;font-size:100}::-moz-selection{background-color:#42b983;color:#fff}::selection{background-color:#42b983;color:#fff}body{margin:0 0 0 calc(100vw - 100%);color:#2c3e50;line-height:1.6;font-size:.9375rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body,h1,h2,h3,h4,h5,h6{font-family:Source Sans Pro,Helvetica Neue,Arial,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:2.34375rem;line-height:3.25rem;margin-top:6.5rem;margin-bottom:1.625rem}h2{font-size:1.58203rem;line-height:2.4375rem}h2,h3{margin-top:3.25rem;margin-bottom:.8125rem}h3{font-size:1.28906rem;line-height:1.625rem}h4{font-size:1.125rem;margin-top:2.4375rem}h4,h5{line-height:1.625rem;margin-bottom:.8125rem}h5,h6{font-size:.9375rem;margin-top:4.0625rem}h6{line-height:1.625rem;margin-bottom:.8125rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#2c3e50;height:1.625rem;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#2c3e50 0,#2c3e50 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#42b983;text-decoration:none}a:active,a:focus,a:hover{color:#f7a046}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.625rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.625rem;margin-bottom:1.625rem}blockquote{padding:0;font-style:italic;text-align:center}figure{display:block;width:100%;height:auto}figcaption{line-height:1.21875rem;margin-top:.40625rem;color:#2c3e50;font-size:.875rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.625rem}.float-right{float:right}.float-left{float:left}}@font-face{font-family:Roboto Mono;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_SeW-AJi8SJQtQ4Y.woff) format("woff");unicode-range:U+0460-052f,U+1c80-1c88,U+20b4,U+2de0-2dff,U+a640-a69f,U+fe2e-fe2f}@font-face{font-family:Roboto Mono;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_QOW-AJi8SJQtQ4Y.woff) format("woff");unicode-range:U+0400-045f,U+0490-0491,U+04b0-04b1,U+2116}@font-face{font-family:Roboto Mono;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_R-W-AJi8SJQtQ4Y.woff) format("woff");unicode-range:U+0370-03ff}@font-face{font-family:Roboto Mono;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_S-W-AJi8SJQtQ4Y.woff) format("woff");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01a0-01a1,U+01af-01b0,U+1ea0-1ef9,U+20ab}@font-face{font-family:Roboto Mono;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_SuW-AJi8SJQtQ4Y.woff) format("woff");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-family:Roboto Mono;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_ROW-AJi8SJQt.woff) format("woff");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3ik4zwmhdu3cOWxy40.woff2) format("woff2");unicode-range:U+0460-052f,U+1c80-1c88,U+20b4,U+2de0-2dff,U+a640-a69f,U+fe2e-fe2f}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3ik4zwkxdu3cOWxy40.woff2) format("woff2");unicode-range:U+0400-045f,U+0490-0491,U+04b0-04b1,U+2116}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3ik4zwmxdu3cOWxy40.woff2) format("woff2");unicode-range:U+1f??}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3ik4zwlBdu3cOWxy40.woff2) format("woff2");unicode-range:U+0370-03ff}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3ik4zwmBdu3cOWxy40.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01a0-01a1,U+01af-01b0,U+1ea0-1ef9,U+20ab}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3ik4zwmRdu3cOWxy40.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3ik4zwlxdu3cOWxw.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xK3dSBYKcSV-LCoeQqfX1RYOo3qNa7lujVj9_mf.woff2) format("woff2");unicode-range:U+0460-052f,U+1c80-1c88,U+20b4,U+2de0-2dff,U+a640-a69f,U+fe2e-fe2f}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xK3dSBYKcSV-LCoeQqfX1RYOo3qPK7lujVj9_mf.woff2) format("woff2");unicode-range:U+0400-045f,U+0490-0491,U+04b0-04b1,U+2116}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xK3dSBYKcSV-LCoeQqfX1RYOo3qNK7lujVj9_mf.woff2) format("woff2");unicode-range:U+1f??}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xK3dSBYKcSV-LCoeQqfX1RYOo3qO67lujVj9_mf.woff2) format("woff2");unicode-range:U+0370-03ff}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xK3dSBYKcSV-LCoeQqfX1RYOo3qN67lujVj9_mf.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01a0-01a1,U+01af-01b0,U+1ea0-1ef9,U+20ab}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xK3dSBYKcSV-LCoeQqfX1RYOo3qNq7lujVj9_mf.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xK3dSBYKcSV-LCoeQqfX1RYOo3qOK7lujVj9w.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwmhdu3cOWxy40.woff2) format("woff2");unicode-range:U+0460-052f,U+1c80-1c88,U+20b4,U+2de0-2dff,U+a640-a69f,U+fe2e-fe2f}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwkxdu3cOWxy40.woff2) format("woff2");unicode-range:U+0400-045f,U+0490-0491,U+04b0-04b1,U+2116}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwmxdu3cOWxy40.woff2) format("woff2");unicode-range:U+1f??}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwlBdu3cOWxy40.woff2) format("woff2");unicode-range:U+0370-03ff}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwmBdu3cOWxy40.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01a0-01a1,U+01af-01b0,U+1ea0-1ef9,U+20ab}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwmRdu3cOWxy40.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwlxdu3cOWxw.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}code[class*=language-],pre[class*=language-]{color:#ddcaca;background:none;font-family:Roboto Mono,Consolas,Monaco,courier,monospace,Menlo,source-code-pro,Courier New,monospace;font-feature-settings:normal;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;margin-bottom:0;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{font-size:16px;margin:0;overflow:auto;padding:1.2rem}pre[class*=language-]::selection{background:#27292a}pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:hsla(0,0%,100%,.15)}:not(pre)>code[class*=language-]{border-radius:.3em;background:#f8f8f8;color:#d63200;padding:.15em .2em .05em;white-space:normal}.token.attr-name{color:#addb67;font-style:italic}.token.comment{color:#809393}.token.string,.token.url{color:#addb67}.token.variable{color:#d6deeb}.token.number{color:#f78c6c}.token.builtin,.token.char,.token.constant,.token.function{color:#82aaff}.token.punctuation{color:#c792ea}.token.doctype,.token.selector{color:#c792ea;font-style:"italic"}.token.class-name{color:#ffcb8b}.token.keyword,.token.operator,.token.tag{color:#ffa7c4}.token.boolean{color:#ff5874}.token.property{color:#80cbc4}.token.namespace{color:#b2ccd6}pre[data-line]{padding:1em 0 1em 3em;position:relative}.gatsby-highlight-code-line{background-color:#022a4b;display:block;padding-right:1em;padding-left:1.25em;border-left:.25em solid #ffa7c4}.gatsby-highlight,.gatsby-highlight-code-line{margin-right:-1.3125rem;margin-left:-1.3125rem}.gatsby-highlight{margin-bottom:1.75rem;border-radius:10px;background:#011627;-webkit-overflow-scrolling:touch;overflow:auto}@media (max-width:672px){.gatsby-highlight{border-radius:0}}.gatsby-highlight pre[class*=language-]{float:left}.Author-module--author__photo--36xCH{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--2CaTb{font-size:1.05469rem;font-weight:600;line-height:1.82813rem;margin:.8125rem 0}.Author-module--author__title-link--Yrism,.Author-module--author__title-link--Yrism:focus,.Author-module--author__title-link--Yrism:hover{color:#2c3e50}.Author-module--author__subtitle--cAaEB{color:#8aa4be;line-height:1.625rem;margin-bottom:1.625rem}.Icon-module--icon--Gpyvw{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--1rGd1{margin-bottom:1.625rem}.Contacts-module--contacts__list--3OgdW{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--16p9q{padding:0;margin:.25rem;display:flex;align-content:center;align-items:center;justify-content:center;height:2.1875rem;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #fff}.Contacts-module--contacts__list-item-link--2MIDn{border:0;display:flex;color:#2c3e50}.Contacts-module--contacts__list-item-link--2MIDn:focus,.Contacts-module--contacts__list-item-link--2MIDn:hover{color:#42b983}.Copyright-module--copyright--1ariN{color:#c5d2df;font-size:.875rem}.Menu-module--menu--Efbin{margin-bottom:1.625rem}.Menu-module--menu__list--31Zeo{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--1lJ6B{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--10Ush{font-size:.9375rem;color:#2c3e50;font-weight:400;border:0}.Menu-module--menu__list-item-link--10Ush:focus,.Menu-module--menu__list-item-link--10Ush:hover{color:#42b983;border-bottom:1px solid #42b983}.Menu-module--menu__list-item-link--active--2CbUO{color:#2c3e50;border-bottom:1px solid #2c3e50}.Sidebar-module--sidebar--X4z2p{width:100%}.Sidebar-module--sidebar__inner--Jdc5s{position:relative;padding:1.5625rem 1.25rem 0}@media screen and (min-width:685px){.Sidebar-module--sidebar--X4z2p{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--Jdc5s:after{background:#fff;background:linear-gradient(180deg,#fff 0,#fff 48%,#fff);position:absolute;content:"";width:.0625rem;height:33.75rem;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--X4z2p{width:calc(33.3% - 1.25rem)}.Sidebar-module--sidebar--X4z2p:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--X4z2p:last-child{margin-right:0}.Sidebar-module--sidebar--X4z2p:nth-child(3n){margin-right:0;float:right}.Sidebar-module--sidebar--X4z2p:nth-child(3n+1){clear:both}.Sidebar-module--sidebar__inner--Jdc5s{padding:2.5rem}}.Layout-module--layout--3Pyz6{max-width:66.875rem;margin-left:auto;margin-right:auto}.Layout-module--layout--3Pyz6:before{content:"";display:table}.Layout-module--layout--3Pyz6:after{content:"";display:table;clear:both}.Feed-module--feed__item--2D5rE{margin-bottom:2.03125rem}.Feed-module--feed__item--2D5rE:last-child{margin-bottom:.8125rem}.Feed-module--feed__item-title--3nigr{font-size:1.58203rem;line-height:2.4375rem;margin-top:0;margin-bottom:.8125rem}.Feed-module--feed__item-title-link--iFMRs{color:#2c3e50}.Feed-module--feed__item-title-link--iFMRs:focus,.Feed-module--feed__item-title-link--iFMRs:hover{color:#2c3e50;border-bottom:1px solid #2c3e50}.Feed-module--feed__item-description--1uO8e{font-size:.9375rem;line-height:1.625rem;margin-bottom:1.21875rem}.Feed-module--feed__item-meta-time--3t1fg{font-size:.875rem;color:#2c3e50;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-divider--N-Q0A{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--23f8F{font-size:.875rem;color:#f7a046;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--23f8F:focus,.Feed-module--feed__item-meta-category-link--23f8F:hover{color:#42b983}.Feed-module--feed__item-readmore--1u6bI{font-size:.9375rem;color:#42b983}.Feed-module--feed__item-readmore--1u6bI:focus,.Feed-module--feed__item-readmore--1u6bI:hover{color:#42b983;border-bottom:1px solid #42b983}.Page-module--page--2nMky{margin-bottom:3.25rem}.Page-module--page__inner--2M_vz{margin-top:5rem;padding:1.5625rem 1.25rem}.Page-module--page__title--GPD8L{font-size:2.34375rem;font-weight:600;line-height:3.25rem;margin-top:0;margin-bottom:2.35625rem}.Page-module--page__body--Ic6i6{font-size:.9375rem;line-height:1.625rem;margin:0 0 1.625rem}@media screen and (min-width:685px){.Page-module--page--2nMky{width:calc(58.275% - .78125rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(12n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(12n+1){clear:both}.Page-module--page__inner--2M_vz{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--2nMky{width:calc(66.6% - .625rem)}.Page-module--page--2nMky:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--2nMky:last-child{margin-right:0}.Page-module--page--2nMky:nth-child(3n){margin-right:0;float:right}.Page-module--page--2nMky:nth-child(3n+1){clear:both}.Page-module--page__inner--2M_vz{padding:2.5rem 2.1875rem}}.Pagination-module--pagination--2H3nO{margin-top:3.25rem;display:flex}.Pagination-module--pagination__prev--bet5s{width:50%;text-align:left}.Pagination-module--pagination__prev-link--1Nzs6{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--1Nzs6:focus,.Pagination-module--pagination__prev-link--1Nzs6:hover{color:#42b983}.Pagination-module--pagination__prev-link--disable--Yklx9{pointer-events:none;color:#cbd7e3}.Pagination-module--pagination__next--3hFiN{width:50%;text-align:right}.Pagination-module--pagination__next-link--3FUtA{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3FUtA:focus,.Pagination-module--pagination__next-link--3FUtA:hover{color:#42b983}.Pagination-module--pagination__next-link--disable--30UwZ{pointer-events:none;color:#cbd7e3}.Meta-module--meta--1XDVh{max-width:46.25rem;margin-left:auto;margin-right:auto}.Meta-module--meta__date--29eD7{font-weight:700}.Content-module--content--3p512{max-width:59.0625rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--2BDW9{font-size:1.875rem;max-width:46.25rem;font-weight:600;text-align:center;line-height:2.68125rem;margin:1.625rem auto 0}.Content-module--content__body--2TrQ- figure{margin-bottom:1.625rem}.Content-module--content__body--2TrQ- figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.625rem 0}.Content-module--content__body--2TrQ- figure blockquote p{max-width:46.25rem;font-size:1.57659rem;margin-top:0;margin-bottom:1.625rem;line-height:2.4375rem}.Content-module--content__body--2TrQ- *{max-width:46.25rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2TrQ- img{max-width:100%}@media screen and (min-width:960px){.Content-module--content--3p512{padding:0}.Content-module--content__title--2BDW9{font-size:2.8125rem;line-height:3.65625rem;margin-top:3.65625rem;margin-bottom:2.4375rem}.Content-module--content__body--2TrQ-,.Content-module--content__body--2TrQ- p{font-size:1.05469rem;line-height:1.82813rem;margin-bottom:1.82813rem}}.Tags-module--tags--1L_ct{margin-bottom:.8125rem}.Tags-module--tags__list--91FqN{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--1M30P{display:inline-block;margin:.625rem .3125rem;border-radius:1.25rem}.Tags-module--tags__list-item-link--3SL_8{display:inline-block;padding:0 .5rem;color:#fff;font-weight:700;background-color:#42b983;border-radius:.25rem;border-bottom:4px solid #3aa373}.Tags-module--tags__list-item-link--3SL_8:focus,.Tags-module--tags__list-item-link--3SL_8:hover{color:#fff;text-decoration:underline}.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{max-width:46.25rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__home-button--16Kl0{display:block;float:left;max-width:11.875rem;height:2.1875rem;line-height:2.1875rem;text-align:center;color:#2c3e50;font-size:.9375rem;font-weight:400;margin-left:auto;margin-right:auto}.Post-module--post__home-button--16Kl0:focus,.Post-module--post__home-button--16Kl0:hover{color:#2c3e50}@media screen and (min-width:960px){.Post-module--post__comments--25y6I,.Post-module--post__footer--3WzWU{padding:0}.Post-module--post__home-button--16Kl0{color:#f7a046;font-weight:700;font-size:1.5625rem}}</style><meta name="generator" content="Gatsby 2.32.13"/><link rel="alternate" type="application/rss+xml" title="A blog by Fish" href="/blog/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-73379983-2"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-73379983-2', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/blog/sitemap.xml"/><link rel="icon" href="/blog/favicon-32x32.png?v=0d1ae485b869926285547d68f24089ad" type="image/png"/><link rel="manifest" href="/blog/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/blog/icons/icon-48x48.png?v=0d1ae485b869926285547d68f24089ad"/><link rel="apple-touch-icon" sizes="72x72" href="/blog/icons/icon-72x72.png?v=0d1ae485b869926285547d68f24089ad"/><link rel="apple-touch-icon" sizes="96x96" href="/blog/icons/icon-96x96.png?v=0d1ae485b869926285547d68f24089ad"/><link rel="apple-touch-icon" sizes="144x144" href="/blog/icons/icon-144x144.png?v=0d1ae485b869926285547d68f24089ad"/><link rel="apple-touch-icon" sizes="192x192" href="/blog/icons/icon-192x192.png?v=0d1ae485b869926285547d68f24089ad"/><link rel="apple-touch-icon" sizes="256x256" href="/blog/icons/icon-256x256.png?v=0d1ae485b869926285547d68f24089ad"/><link rel="apple-touch-icon" sizes="384x384" href="/blog/icons/icon-384x384.png?v=0d1ae485b869926285547d68f24089ad"/><link rel="apple-touch-icon" sizes="512x512" href="/blog/icons/icon-512x512.png?v=0d1ae485b869926285547d68f24089ad"/><title data-react-helmet="true">(è¯‘)å®ç°è‡ªå·±çš„ React - A blog by Fish</title><meta data-react-helmet="true" name="description" content="Build Your Own React"/><meta data-react-helmet="true" property="og:site_name" content="(è¯‘)å®ç°è‡ªå·±çš„ React - A blog by Fish"/><meta data-react-helmet="true" property="og:image" content="https://icyfish.github.io/photo.jpg"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="(è¯‘)å®ç°è‡ªå·±çš„ React - A blog by Fish"/><meta data-react-helmet="true" name="twitter:description" content="Build Your Own React"/><meta data-react-helmet="true" name="twitter:image" content="https://icyfish.github.io/photo.jpg"/><link as="script" rel="preload" href="/blog/webpack-runtime-210c2a8693fb3712f1d9.js"/><link as="script" rel="preload" href="/blog/framework-1e331b2e9d55ebef6dec.js"/><link as="script" rel="preload" href="/blog/532a2f07-549094fa347c85980056.js"/><link as="script" rel="preload" href="/blog/dc6a8720040df98778fe970bf6c000a41750d3ae-5954f1f1c3eead9a6f74.js"/><link as="script" rel="preload" href="/blog/app-7bab443a509de4091087.js"/><link as="script" rel="preload" href="/blog/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/blog/cd95ea5cbd2c605f26db819f07999610c9ff4310-cb79b714c9287bd00e29.js"/><link as="script" rel="preload" href="/blog/component---src-templates-post-template-js-fabfe238f8e25964e858.js"/><link as="fetch" rel="preload" href="/blog/page-data/posts/build-your-own-react/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/sq/d/251939775.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/sq/d/401334301.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/sq/d/825871152.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--3Pyz6"><style data-emotion-css="o83204">.css-o83204{--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity));position:fixed;display:none;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border-radius:0.25rem;padding:0.75rem;margin-top:0.75rem;margin-bottom:0.75rem;width:20rem;left:calc(50% + 400px);top:50px;}@media (min-width:1024px){.css-o83204{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}</style><ul class="css-o83204"><style data-emotion-css="1gx59eq">.css-1gx59eq{font-size:1.5rem;line-height:2rem;margin-bottom:0.5rem;}</style><h2 class="css-1gx59eq">Table of contents</h2><style data-emotion-css="1ogspyd">.css-1ogspyd{-webkit-scrollbar-width:thin;-moz-scrollbar-width:thin;-ms-scrollbar-width:thin;scrollbar-width:thin;-webkit-scrollbar-color:#367ee9 rgba(48,113,209,0.3);-moz-scrollbar-color:#367ee9 rgba(48,113,209,0.3);-ms-scrollbar-color:#367ee9 rgba(48,113,209,0.3);scrollbar-color:#367ee9 rgba(48,113,209,0.3);overflow:hidden auto;}</style><div class="css-1ogspyd"><style data-emotion-css="1dvi42b">.css-1dvi42b{padding:0.25rem;line-height:.75rem;margin-left:1rem;margin-bottom:1rem;margin-right:1rem;list-style-type:none;}</style><li class="css-1dvi42b"><style data-emotion-css="1y7cc89">.css-1y7cc89{-webkit-transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,-webkit-transform,filter,backdrop-filter;-webkit-transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;-webkit-transition-timing-function:cubic-bezier(0.4,0,0.2,1);transition-timing-function:cubic-bezier(0.4,0,0.2,1);-webkit-transition-duration:300ms;transition-duration:300ms;}</style><a href="#æ¦‚è§ˆ" class="css-1y7cc89">æ¦‚è§ˆ</a></li><li class="css-1dvi42b"><a href="#å®ç°-createelement-å‡½æ•°" class="css-1y7cc89">å®ç° createElement å‡½æ•°</a></li><li class="css-1dvi42b"><a href="#å®ç°-render-æ–¹æ³•" class="css-1y7cc89">å®ç° render æ–¹æ³•</a></li><li class="css-1dvi42b"><a href="#å®ç°-concurrent-æ¨¡å¼" class="css-1y7cc89">å®ç° Concurrent æ¨¡å¼</a></li><li class="css-1dvi42b"><a href="#fibers" class="css-1y7cc89">Fibers</a></li><li class="css-1dvi42b"><a href="#æ¸²æŸ“ä¸æäº¤é˜¶æ®µ-commit" class="css-1y7cc89">æ¸²æŸ“ä¸æäº¤é˜¶æ®µ Commit</a></li><li class="css-1dvi42b"><a href="#åè°ƒ-reconciliation" class="css-1y7cc89">åè°ƒ Reconciliation</a></li><li class="css-1dvi42b"><a href="#å‡½æ•°å¼ç»„ä»¶" class="css-1y7cc89">å‡½æ•°å¼ç»„ä»¶</a></li><li class="css-1dvi42b"><a href="#hooks" class="css-1y7cc89">Hooks</a></li><li class="css-1dvi42b"><a href="#åè®°" class="css-1y7cc89">åè®°</a></li></div></ul><div><a class="Post-module--post__home-button--16Kl0" href="/blog/">Fish&#x27;s blog ğŸŸ</a><div><div class="Content-module--content--3p512"><h1 class="Content-module--content__title--2BDW9">(è¯‘)å®ç°è‡ªå·±çš„ React</h1><div class="Meta-module--meta--1XDVh"><p class="Meta-module--meta__date--29eD7">Dec 25, 2020</p></div><div class="Content-module--content__body--2TrQ-"><p><a href="https://pomb.us/build-your-own-react/" target="_blank" rel="nofollow noopener noreferrer">åŸæ–‡: Build your own React</a></p>
<!-- ```toc
# This code block gets replaced with the TOC
``` -->
<p>è¿™æ˜¯ä¸€ä¸ªä»é›¶å¼€å§‹å®ç° React çš„æ•™ç¨‹ï¼Œä¸ç”Ÿäº§ç‰ˆæœ¬æœ‰æ‰€å·®å¼‚çš„æ˜¯ï¼Œæˆ‘ä»¬ä¼šå¿½ç•¥æ‰€æœ‰ä¼˜åŒ–çš„ç»†èŠ‚ï¼ŒåŒæ—¶å¿½ç•¥ä¸€äº›ä¸ä¸»è¦åŸç†æ— å…³çš„ç‰¹æ€§ã€‚</p>
<p>ä¹Ÿè®¸ä½ é˜…è¯»è¿‡æˆ‘ä¹‹å‰å†™è¿‡çš„<a href="https://engineering.hexacta.com/didact-learning-how-react-works-by-building-it-from-scratch-51007984e5c5" target="_blank" rel="nofollow noopener noreferrer">ç±»ä¼¼æ•™ç¨‹</a>ï¼Œè¿™ç¯‡æ•™ç¨‹ä¸ä¹‹å‰æ•™ç¨‹çš„åŒºåˆ«æ˜¯ï¼Œæœ¬æ•™ç¨‹çš„æºä»£ç åŸºäº React 16.8 ç‰ˆæœ¬ï¼Œå› æ­¤æœ¬æ•™ç¨‹åŒ…å«äº† hooks çš„ç‰¹æ€§ï¼ŒåŒæ—¶ä¸åŒ…å« class ç‰ˆæœ¬ç»„ä»¶çš„å®ç°ã€‚</p>
<p>å¦‚æœä½ åŒæ—¶å¸Œæœ›å­¦ä¹ æ—§ç‰ˆæœ¬çš„å®ç°ï¼Œå¯ä»¥æŸ¥çœ‹æ—§ç‰ˆçš„æ•™ç¨‹ä»¥åŠä¸ä¹‹ç›¸å…³çš„æ—§ç‰ˆ<a href="https://github.com/pomber/didact" target="_blank" rel="nofollow noopener noreferrer">å®ç°æºç </a>ã€‚åŒæ—¶è¿˜æœ‰ä¸€ä¸ª<a href="https://www.youtube.com/watch?v=8Kc2REHdwnQ&#x26;feature=youtu.be" target="_blank" rel="nofollow noopener noreferrer">è§†é¢‘è§£è¯´</a>ä»¥ä¾›å‚è€ƒã€‚ä¸è¿‡é˜…è¯»æœ¬æ•™ç¨‹å¹¶ä¸å¼ºåˆ¶è¦æ±‚ä½ å­¦ä¹ è¿‡ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœ¬æ•™ç¨‹çš„å†…å®¹æ˜¯ç‹¬ç«‹å®Œæ•´çš„ã€‚</p>
<p>æˆ‘å°†å®ç°è¿‡ç¨‹æ‹†åˆ†æˆäº†ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li>å®ç° <code class="language-text">createElement</code> å‡½æ•°</li>
<li>å®ç° <code class="language-text">render</code> å‡½æ•°</li>
<li>Concurrent æ¨¡å¼</li>
<li>Fibers</li>
<li>æ¸²æŸ“ä¸æäº¤é˜¶æ®µ (Commit)</li>
<li>åè°ƒ Reconciliation</li>
<li>å‡½æ•°å¼ç»„ä»¶</li>
<li>Hooks</li>
</ol>
<h2 id="æ¦‚è§ˆ" style="position:relative;"><a href="#%E6%A6%82%E8%A7%88" aria-label="æ¦‚è§ˆ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>æ¦‚è§ˆ</h2>
<p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹å‡ ä¸ªåŸºæœ¬æ¦‚å¿µã€‚å¦‚æœä½ å¯¹ Reactï¼ŒJSX å’Œ DOM å…ƒç´ çš„å®ç°å·²ç»æœ‰äº†æ¯”è¾ƒæ·±åˆ»çš„ç†è§£ï¼Œå¯ä»¥è·³è¿‡è¿™éƒ¨åˆ†çš„ä»‹ç»ç›´æ¥è¿›å…¥ä¸‹ä¸€éƒ¨åˆ†ã€‚</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>foo<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">Hello</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
<span class="token keyword">const</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> container<span class="token punctuation">)</span></code></pre></div>
<p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ React åº”ç”¨ï¼Œä»…ä»…åŒ…å«äº†ä¸‰è¡Œä»£ç ã€‚ç¬¬ä¸€è¡Œå®šä¹‰äº†ä¸€ä¸ª React å…ƒç´ ã€‚ç¬¬äºŒè¡Œåˆ©ç”¨ Web API è·å–äº† DOM ä¸­çš„æŸä¸€ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘å°†å®ƒç§°ä¸ºå®¹å™¨ã€‚æœ€åä¸€è¡Œåˆ™æ˜¯å°†æˆ‘ä»¬çš„ React å…ƒç´ æ’å…¥åˆ°å®¹å™¨çš„æ“ä½œã€‚</p>
<p><strong>ç°åœ¨æˆ‘ä»¬æŠŠæ‰€æœ‰ React ç›¸å…³çš„ä»£ç å…¨éƒ¨æ›¿æ¢ä¸ºåŸç”Ÿ JavaScript ä»£ç ã€‚</strong></p>
<p>ç¬¬ä¸€è¡Œä»£ç ï¼Œä½¿ç”¨çš„æ˜¯ JSX è¯­æ³•ï¼Œå®ƒå¹¶ä¸æ˜¯åŸç”Ÿçš„ JavaScript ä»£ç ï¼Œå› æ­¤æˆ‘ä»¬å¯¹å®ƒåšå‡ºä¸€äº›ä¿®æ”¹ï¼š</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">const</span> element <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>
  <span class="token string">"h1"</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">"foo"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"Hello"</span>
<span class="token punctuation">)</span></code></pre></div>
<p>JSX ä»£ç ä¼šè¢«ç±»ä¼¼ Babel çš„ç¼–è¯‘å·¥å…·è¿›è¡Œå¤„ç†ï¼Œè½¬æ¢æˆåŸç”Ÿ JavaScript ä»£ç ã€‚è½¬æ¢è¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼šå°† <code class="language-text">&lt;</code> <code class="language-text">&gt;</code> æ ‡ç­¾ç§»é™¤ï¼Œä½¿ç”¨ <code class="language-text">createElement</code> å‡½æ•°è°ƒç”¨è¿›è¡Œæ›¿æ¢ï¼Œä¼ å…¥çš„å‚æ•°åˆ†åˆ«ä¸ºï¼šæ ‡ç­¾åç§°ï¼Œå…ƒç´ å‚æ•°ï¼Œä»¥åŠå…ƒç´ çš„å­å…ƒç´ ã€‚</p>
<p><code class="language-text">React.createElement</code> ï¼Œæ ¹æ®æ‰€ä¼ å…¥çš„å‚æ•°ï¼Œåˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ã€‚é™¤äº†ä¸€äº›æœ‰æ•ˆæ€§æ ¡éªŒä¹‹å¤–ï¼Œæ•´ä½“çš„åŠŸèƒ½å°±æ˜¯ä»¥ä¸Šè¿™æ ·ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠ JSX æ›¿æ¢æˆåŸç”Ÿ JavaScript çš„å½¢å¼ï¼Œäººå·¥ç¡®ä¿å…ƒç´ å’Œå±æ€§ç­‰çš„æœ‰æ•ˆæ€§ã€‚</p>
<p>ç»è¿‡ä»¥ä¸Šå¤„ç†ä¹‹åï¼Œæˆ‘ä»¬çš„å…ƒç´ å°±å˜æˆäº†è¿™æ ·çš„å½¢å¼ï¼šä¸€ä¸ªå¯¹è±¡ï¼Œå†…éƒ¨å«æœ‰ä¸¤ä¸ªå±æ€§ï¼Œåˆ†åˆ«æ˜¯ <code class="language-text">type</code> å’Œ <code class="language-text">props</code> (å½“ç„¶äº†ï¼Œå®é™…ä¸Š<a href="https://github.com/facebook/react/blob/f4cc45ce962adc9f307690e1d5cfa28a288418eb/packages/react/src/ReactElement.js#L111" target="_blank" rel="nofollow noopener noreferrer">åŒ…å«æ›´å¤š</a>ï¼Œç›®å‰æˆ‘ä»¬åªå…³æ³¨è¿™ä¸¤ä¸ªå°±å¯ä»¥ã€‚ï¼‰</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token punctuation">{</span>
  type<span class="token operator">:</span> <span class="token string">"h1"</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token string">"foo"</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token string">"Hello"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">type</code> å±æ€§çš„å€¼æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œè¡¨ç¤ºæˆ‘ä»¬æ‰€å¸Œæœ›åˆ›å»ºçš„ DOM å…ƒç´ ç±»å‹ï¼Œç›¸å½“äºå½“ä½ å¸Œæœ›åˆ›å»ºä¸€ä¸ª HTML å…ƒç´ çš„æ—¶å€™ï¼Œä¼ å…¥ <code class="language-text">document.createElement</code> å‡½æ•°ä¸­çš„æ ‡ç­¾åã€‚å½“ç„¶é™¤äº†å­—ç¬¦ä¸²ç±»å‹ä¹‹å¤–ï¼Œ<code class="language-text">type</code> çš„å€¼è¿˜å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ç‚¹æˆ‘ä»¬ä¼šåœ¨å‡½æ•°å¼ç»„ä»¶çš„é‚£ä¸€éƒ¨åˆ†ä¸­è¯¦ç»†ä»‹ç»ã€‚</p>
<p><code class="language-text">props</code> æ˜¯å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­çš„å†…å®¹åŒ…æ‹¬æ‰€æœ‰ JSX å±æ€§ä¸­çš„é”®å€¼å¯¹ã€‚æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§éœ€è¦ç‰¹åˆ«å…³æ³¨ï¼Œå°±æ˜¯ <code class="language-text">children</code> ã€‚</p>
<p>åœ¨æˆ‘ä»¬å½“å‰çš„ç¤ºä¾‹ä¸­ï¼Œ<code class="language-text">children</code> çš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸è¿‡åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ<code class="language-text">children</code> çš„å€¼ä¼šæ˜¯ä¸€ä¸ªåŒ…å«å¾ˆå¤šå…ƒç´ çš„æ•°ç»„ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ, å…ƒç´ çš„æ•°æ®ç»“æ„æ˜¯æ ‘çš„åŸå› ã€‚</p>
<p>æˆ‘ä»¬çš„ç®€æ˜“ React åº”ç”¨ä¸­ï¼Œç¬¬ä¸‰è¡Œä»£ç ï¼ˆ<code class="language-text">ReactDOM.render</code>ï¼‰ä¹Ÿä¸æ˜¯åŸç”Ÿçš„ JavaScript ä»£ç ï¼ŒåŒæ ·éœ€è¦è¿›è¡Œè½¬æ¢ã€‚</p>
<p>åœ¨ <code class="language-text">render</code> æ–¹æ³•ä¸­ï¼ŒReact å…ƒç´ è¢«è½¬æ¢å¹¶æ¸²æŸ“åˆ°äº† DOM ä¸­ï¼Œç°åœ¨æˆ‘ä»¬è¦ç”¨è‡ªå·±çš„æ–¹æ³•å»å®ç°è¿™ä¸€æ­¥ã€‚</p>
<p>é¦–å…ˆéœ€è¦åšçš„æ˜¯ï¼Œåˆ©ç”¨ç¬¬ä¸€æ­¥çš„ <code class="language-text">type</code> å±æ€§ï¼Œåˆ›å»ºä¸€ä¸ª DOM èŠ‚ç‚¹ï¼Œæœ¬ä¾‹ä¸­æˆ‘ä»¬çš„ <code class="language-text">type</code> å±æ€§æ˜¯ <code class="language-text">h1</code> æ ‡ç­¾ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬å°†æ‰€æœ‰å…ƒç´ å±æ€§éƒ½èµ‹åˆ°å¯¹åº”çš„ DOM èŠ‚ç‚¹ä¸­ã€‚æœ¬ä¾‹ä¸­åªæœ‰ title å±æ€§ã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> node <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>type<span class="token punctuation">)</span>
node<span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">.</span>props<span class="token punctuation">.</span>title</code></pre></div>
<p>ä¸ºäº†é¿å…æ··æ·†ï¼Œæˆ‘ä¼šç”¨â€œå…ƒç´ â€æ¥è¡¨ç¤º React å…ƒç´ ï¼Œâ€œèŠ‚ç‚¹â€æ¥è¡¨ç¤º DOM å…ƒç´ ã€‚</p>
<p>æ¥ä¸‹æ¥è¦å¤„ç†å­å…ƒç´ æ‰€å¯¹åº”çš„èŠ‚ç‚¹äº†ã€‚æœ¬ä¾‹ä¸­æˆ‘ä»¬çš„å­å…ƒç´ æ˜¯æ–‡æœ¬ï¼Œå› æ­¤åªéœ€è¦åˆ›å»ºä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹å³å¯ã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> text <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>
text<span class="token punctuation">[</span><span class="token string">"nodeValue"</span><span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">.</span>props<span class="token punctuation">.</span>children</code></pre></div>
<p>æ¸²æŸ“æ–‡æœ¬èŠ‚ç‚¹ä½¿ç”¨çš„æ˜¯ <code class="language-text">createTextNode</code> è€Œä¸æ˜¯ <code class="language-text">innerText</code>, å¯ä»¥ä¿è¯åœ¨åç»­å¤„ç†å…ƒç´ æ—¶, æ‰€æœ‰å…ƒç´ çš„å½¢å¼éƒ½æ˜¯ä¸€è‡´çš„, æŠ¹å¹³å·®å¼‚, ç»Ÿä¸€å¤„ç†. ä½¿ç”¨ <code class="language-text">createTextNode</code> æ—¶, æ–‡æœ¬ä¹Ÿæ˜¯å±æ€§, key ä¸º <code class="language-text">nodeValue</code> ï¼Œä¸ä¹‹å‰é’ˆå¯¹ <code class="language-text">h1</code> çš„å¤„ç†æ˜¯ç±»ä¼¼çš„ï¼š<code class="language-text">props: {nodeValue: &quot;hello&quot;}</code> </p>
<p>æœ€åå°† <code class="language-text">textNode</code> æ·»åŠ åˆ° <code class="language-text">h1</code> ï¼Œå°† <code class="language-text">h1</code> æ·»åŠ åˆ°å®¹å™¨ä¸­ã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token punctuation">{</span>
  type<span class="token operator">:</span> <span class="token string">"h1"</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token string">"foo"</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token string">"Hello"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> node <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>type<span class="token punctuation">)</span>
node<span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">.</span>props<span class="token punctuation">.</span>title

<span class="token keyword">const</span> text <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>
text<span class="token punctuation">[</span><span class="token string">"nodeValue"</span><span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">.</span>props<span class="token punctuation">.</span>children

node<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
container<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span></code></pre></div>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®ç°äº†ä¸ä¹‹å‰ä¸€è‡´çš„åº”ç”¨ï¼Œå¹¶ä¸”æ²¡æœ‰ä½¿ç”¨ä»»ä½•ä¸ React ç›¸å…³çš„ä»£ç ã€‚</p>
<h2 id="å®ç°-createelement-å‡½æ•°" style="position:relative;"><a href="#%E5%AE%9E%E7%8E%B0-createelement-%E5%87%BD%E6%95%B0" aria-label="å®ç° createelement å‡½æ•° permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>å®ç° createElement å‡½æ•°</h2>
<p>ç°åœ¨æˆ‘ä»¬å¼€å§‹å®ç°å¦ä¸€ä¸ªåº”ç”¨ã€‚è¿™æ¬¡å°† React ç›¸å…³çš„ä»£ç æ›¿æ¢æˆæˆ‘ä»¬è‡ªå·±ç‰ˆæœ¬çš„ Reactã€‚</p>
<p>é¦–å…ˆå¼€å§‹å®ç°æˆ‘ä»¬çš„ <code class="language-text">createElement</code> ã€‚</p>
<p>è¿˜æ˜¯å…ˆå°† JSX è½¬æ¢æˆ JSï¼Œä»¥ä¾¿çœ‹åˆ° <code class="language-text">createElement</code> å‡½æ•°è°ƒç”¨ã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>foo<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span><span class="token punctuation">></span></span><span class="token plain-text">bar</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span> <span class="token punctuation">/></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token punctuation">)</span>
<span class="token keyword">const</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> container<span class="token punctuation">)</span></code></pre></div>
<p>åœ¨ä¹‹å‰çš„æ­¥éª¤ä¸­æˆ‘ä»¬çŸ¥é“äº†ï¼šå…ƒç´ å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå†…å«æœ‰ <code class="language-text">type</code> å’Œ <code class="language-text">props</code> å±æ€§ã€‚å› æ­¤æˆ‘ä»¬çš„ <code class="language-text">createElement</code> å‡½æ•°éœ€è¦åšçš„å°±æ˜¯åˆ›å»ºè¿™ä¸ªå…ƒç´ å¯¹è±¡ã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> props<span class="token punctuation">,</span> <span class="token operator">...</span>children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">,</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>props<span class="token punctuation">,</span>
      children<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>æˆ‘ä»¬ä½¿ç”¨  ES6 ä¸­çš„å±•å¼€æ“ä½œç¬¦æ¥å¤„ç† <code class="language-text">props</code> å±æ€§ï¼Œå‰©ä½™å‚æ•°è¯­æ³•æ¥å¤„ç† <code class="language-text">children</code> å±æ€§ï¼Œè¿™æ ·çš„è¯ <code class="language-text">children</code> å±æ€§å°±å§‹ç»ˆæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œ<code class="language-text">createElement(&quot;div&quot;)</code> å‡½æ•°è¿”å›çš„å†…å®¹æ˜¯ï¼š</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"div"</span><span class="token punctuation">,</span>
  <span class="token property">"props"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"children"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">createElement(&quot;div&quot;, null, a)</code> å‡½æ•°è¿”å›çš„å†…å®¹æ˜¯ï¼š</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"div"</span><span class="token punctuation">,</span>
  <span class="token property">"props"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"children"</span><span class="token operator">:</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">createElement(&quot;div&quot;, null, a, b)</code> å‡½æ•°è¿”å›çš„å†…å®¹æ˜¯ï¼š</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"div"</span><span class="token punctuation">,</span>
  <span class="token property">"props"</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"children"</span><span class="token operator">:</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">children</code> æ•°ç»„çš„å†…å®¹è¿˜å¯ä»¥æ˜¯åŸå§‹ç±»å‹çš„å€¼ï¼Œå­—ç¬¦ä¸²æˆ–è€…æ•°å­—ã€‚ç°åœ¨æˆ‘ä»¬å°†æ‰€æœ‰éå¯¹è±¡ç±»å‹çš„å…ƒç´ ç”¨ä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹ <code class="language-text">TEXT_ELEMENT</code> æ¥è¡¨ç¤ºã€‚</p>
<p>åœ¨æ²¡æœ‰ <code class="language-text">children</code> çš„æƒ…å†µä¸‹ï¼ŒReact ä¸ä¼šå°è£…åŸå§‹ç±»å‹çš„å€¼æˆ–è€…æ˜¯åˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„ï¼Œæˆ‘ä»¬è¿™æ ·åšçš„åŸå› æ˜¯ä¸ºäº†ç®€åŒ–ä»£ç ï¼Œæ¯•ç«Ÿç®€å•çš„ä»£ç æ›´åˆ©äºæ•™å­¦ã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> props<span class="token punctuation">,</span> <span class="token operator">...</span>children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">,</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>props<span class="token punctuation">,</span>
      children<span class="token operator">:</span> children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=></span>
        <span class="token keyword">typeof</span> child <span class="token operator">===</span> <span class="token string">"object"</span>
          <span class="token operator">?</span> child
          <span class="token operator">:</span> <span class="token function">createTextElement</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">createTextElement</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">"TEXT_ELEMENT"</span><span class="token punctuation">,</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>
      nodeValue<span class="token operator">:</span> text<span class="token punctuation">,</span>
      children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> element <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>
  <span class="token string">"div"</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">"foo"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"bar"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token keyword">const</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> container<span class="token punctuation">)</span></code></pre></div>
<p>ç›®å‰æˆ‘ä»¬ä¾ç„¶åœ¨ç”¨ React çš„ <code class="language-text">createElement</code> ã€‚</p>
<p>ç°åœ¨ç»™æˆ‘ä»¬è‡ªå·±çš„åº“èµ·ä¸ªåå­—ï¼Œæ¥æ›¿æ¢å®ƒã€‚ä¸ºäº†ä½“ç°å®ƒçš„æ•™å­¦æ„ä¹‰ï¼Œåˆä¿æŒä¸ React çš„åå­—ç±»ä¼¼ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªåº“å«åš Didact ã€‚</p>
<p>ä¸è¿‡æˆ‘è¿˜æ˜¯æƒ³è¦ä½¿ç”¨ JSX è¯­æ³•ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å‘Šè¯‰ babelï¼Œå»ä½¿ç”¨ Didact çš„ <code class="language-text">createElement</code> è€Œä¸æ˜¯ React çš„ <code class="language-text">createElement</code> ã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> Didact <span class="token operator">=</span> <span class="token punctuation">{</span>
  createElement<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> element <span class="token operator">=</span> Didact<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>
  <span class="token string">"div"</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">"foo"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  Didact<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"bar"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Didact<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre></div>
<p>åªéœ€è¦ç®€å•åœ°åŠ ä¸Šè¿™ä¸ªæ³¨é‡Šï¼Œå°±èƒ½å¤Ÿè¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„äº†ï¼š</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">/** @jsx Didact.createElement */</span>
<span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>foo<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span><span class="token punctuation">></span></span><span class="token plain-text">bar</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span> <span class="token punctuation">/></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token punctuation">)</span></code></pre></div>
<h2 id="å®ç°-render-æ–¹æ³•" style="position:relative;"><a href="#%E5%AE%9E%E7%8E%B0-render-%E6%96%B9%E6%B3%95" aria-label="å®ç° render æ–¹æ³• permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>å®ç° render æ–¹æ³•</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦å¼€å§‹å®ç°è‡ªå·±çš„ <code class="language-text">ReactDOM.render</code> å‡½æ•°ã€‚</p>
<p>ç›®å‰ï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨åœ¨ DOM ä¸­æ·»åŠ å†…å®¹å³å¯ã€‚å…ƒç´ çš„æ›´æ–°å’Œåˆ é™¤éƒ½åœ¨åç»­çš„ç« èŠ‚ä¸­è¿›è¡Œé˜è¿°ã€‚</p>
<p>é¦–å…ˆä½¿ç”¨å…ƒç´ çš„ç±»å‹åˆ›å»º DOM èŠ‚ç‚¹ï¼Œç„¶åå°†æ‰€åˆ›å»ºçš„èŠ‚ç‚¹æ·»åŠ åˆ°æˆ‘ä»¬çš„å®¹å™¨ä¸­ã€‚</p>
<p>é’ˆå¯¹æ‰€æœ‰çš„ <code class="language-text">children</code> éƒ½è¦å»é€’å½’åœ°å¤„ç†ã€‚</p>
<p>ä¸æ­¤åŒæ—¶è¿˜è¦å¤„ç†æ–‡æœ¬ç±»å‹çš„å…ƒç´ ï¼Œåˆ›å»ºæ–‡æœ¬èŠ‚ç‚¹è€Œéæ™®é€šèŠ‚ç‚¹ã€‚</p>
<p>æœ€åå°†å…ƒç´ çš„å±æ€§éƒ½æ·»åŠ åˆ° node èŠ‚ç‚¹ä¸­ã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dom <span class="token operator">=</span>
    element<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">"TEXT_ELEMENT"</span>
      <span class="token operator">?</span> document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>
      <span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>type<span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token function-variable function">isProperty</span> <span class="token operator">=</span> <span class="token parameter">key</span> <span class="token operator">=></span> key <span class="token operator">!==</span> <span class="token string">"children"</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>props<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>isProperty<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">name</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      dom<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">.</span>props<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

  element<span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=></span>
    <span class="token function">render</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> dom<span class="token punctuation">)</span>
  <span class="token punctuation">)</span>

  container<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>dom<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>ä»¥ä¸Šæ•´ä½“ä»£ç è§ï¼š<a href="https://codesandbox.io/s/didact-2-k6rbj" target="_blank" rel="nofollow noopener noreferrer">React</a>.</p>
<h2 id="å®ç°-concurrent-æ¨¡å¼" style="position:relative;"><a href="#%E5%AE%9E%E7%8E%B0-concurrent-%E6%A8%A1%E5%BC%8F" aria-label="å®ç° concurrent æ¨¡å¼ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>å®ç° Concurrent æ¨¡å¼</h2>
<p>åœ¨å¼€å§‹å®ç° Concurrent æ¨¡å¼ä¹‹å‰è¦å¯¹æˆ‘ä»¬çš„ä»£ç è¿›è¡Œé‡æ„ã€‚</p>
<p>ä¹‹å‰ç‰ˆæœ¬çš„é€’å½’è°ƒç”¨æœ‰ä¸€ç‚¹é—®é¢˜:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx">element<span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=></span>
  <span class="token function">render</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> dom<span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre></div>
<p>ä¸€æ—¦ç»„ä»¶å¼€å§‹è¿›è¡Œæ¸²æŸ“çš„è¿›ç¨‹ï¼Œåªæœ‰ç­‰å…¨éƒ¨çš„ç»„ä»¶æ ‘æ¸²æŸ“å®Œæ¯•åæ¸²æŸ“æµç¨‹æ‰ä¼šç»“æŸã€‚å¦‚æœç»„ä»¶æ ‘è¿‡å¤§çš„è¯ï¼Œä¼šé•¿æ—¶é—´é˜»ç¢ä¸»è¿›ç¨‹ã€‚å½“æµè§ˆå™¨è¦æ‰§è¡Œä¼˜å…ˆçº§é«˜çš„æ“ä½œï¼ˆæ¯”å¦‚å¤„ç†ç”¨æˆ·è¾“å…¥æˆ–è€…åŠ¨ç”»æ—¶ï¼‰ï¼Œéƒ½éœ€è¦ç­‰å¾…æ¸²æŸ“çš„ç»“æŸï¼Œå¯¹æ€§èƒ½é€ æˆæ¯”è¾ƒå¤§çš„å½±å“ã€‚</p>
<p>å› æ­¤æˆ‘ä»¬è¦å°†æ¸²æŸ“çš„æµç¨‹æ‹†åˆ†æˆä¸€ä¸ªä¸ªå°çš„å•å…ƒï¼Œåœ¨å„ä¸ªå•å…ƒä¹‹é—´ï¼Œæˆ‘ä»¬å¯ä»¥æš‚åœæ¸²æŸ“è¿›ç¨‹ï¼Œå…è®¸æµè§ˆå™¨æ‰§è¡Œå…¶ä»–æ“ä½œã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨ <code class="language-text">[requestIdleCallback](https://developer.mozilla.org/en-US/docs/Web/API/Window/requestIdleCallback)</code> (æµè§ˆå™¨æä¾›çš„ä¸€ä¸ª API )æ¥åˆ›å»ºä¸€ä¸ªå¾ªç¯ã€‚ä¸ºäº†ä¾¿äºç†è§£å¯ä»¥å°† <code class="language-text">requestIdleCallback</code> çœ‹ä½œæ˜¯ <code class="language-text">setTimeout</code>ï¼ŒåŒºåˆ«å°±æ˜¯ï¼Œ<code class="language-text">setTimeout</code> å—æ—¶é—´æ§åˆ¶ï¼Œè€Œ <code class="language-text">requestIdleCallback</code>  åˆ™æ˜¯åœ¨ä¸»è¿›ç¨‹å¤„äºç©ºé—²çš„æƒ…å†µä¸‹è¢«æµè§ˆå™¨æ‰§è¡Œçš„ã€‚</p>
<p>ç°åœ¨ <a href="https://github.com/facebook/react/issues/11171#issuecomment-417349573" target="_blank" rel="nofollow noopener noreferrer">React å·²ç»ä¸å†ä½¿ç”¨</a> <code class="language-text">requestIdleCallback</code> äº†ï¼Œç›®å‰å®ƒçš„æ›¿ä»£æ–¹æ¡ˆæ˜¯ <a href="https://github.com/facebook/react/tree/master/packages/scheduler" target="_blank" rel="nofollow noopener noreferrer">scheduler</a> åŒ…ã€‚ä¸è¿‡ä¸¤è€…æ‰€å®ç°çš„ä¸»è¦åŠŸèƒ½ç›¸å·®æ— å‡ ã€‚</p>
<p><code class="language-text">requestIdleCallback</code> è¿˜æ¥å—ä¸€ä¸ªç±»ä¼¼æœ€åæœŸé™ ï¼ˆdeadlineï¼‰çš„å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‚æ•°çŸ¥é“æµè§ˆå™¨è¿˜æœ‰å¤šé•¿æ—¶é—´ä¹‹å, ä¼šé‡æ–°è·å–æ§åˆ¶æƒã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">let</span> nextUnitOfWork <span class="token operator">=</span> <span class="token keyword">null</span>

<span class="token keyword">function</span> <span class="token function">workLoop</span><span class="token punctuation">(</span><span class="token parameter">deadline</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> shouldYield <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token comment">// åœæ­¢æ“ä½œçš„ flag</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>nextUnitOfWork <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>shouldYield<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    nextUnitOfWork <span class="token operator">=</span> <span class="token function">performUnitOfWork</span><span class="token punctuation">(</span>
      nextUnitOfWork
    <span class="token punctuation">)</span>
    shouldYield <span class="token operator">=</span> deadline<span class="token punctuation">.</span><span class="token function">timeRemaining</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
  <span class="token function">requestIdleCallback</span><span class="token punctuation">(</span>workLoop<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">requestIdleCallback</span><span class="token punctuation">(</span>workLoop<span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">performUnitOfWork</span><span class="token punctuation">(</span><span class="token parameter">nextUnitOfWork</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO</span>
<span class="token punctuation">}</span></code></pre></div>
<p>æˆªæ­¢æœ¬æ–‡æ’°å†™çš„æ—¶é—´ï¼ˆ2019å¹´11æœˆï¼‰ï¼ŒConcurrent æ¨¡å¼åœ¨ React ä¸­è¿˜å¹¶éç¨³å®šç‰¹æ€§ï¼Œå¤„äºå®éªŒé˜¶æ®µã€‚ç¨³å®šç‰ˆæœ¬çš„å¾ªç¯ä»£ç å¤§æ¦‚åƒæ˜¯ä¸‹é¢è¿™æ ·ï¼š</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">while</span> <span class="token punctuation">(</span>nextUnitOfWork<span class="token punctuation">)</span> <span class="token punctuation">{</span>    
  nextUnitOfWork <span class="token operator">=</span> <span class="token function">performUnitOfWork</span><span class="token punctuation">(</span>   
    nextUnitOfWork  
  <span class="token punctuation">)</span> 
<span class="token punctuation">}</span></code></pre></div>
<p>è¦æƒ³å¼€å§‹è¿™æ®µå¾ªç¯ (workLoop)ï¼Œé¦–å…ˆè¦è®¾ç½®é¦–ä¸ªå•å…ƒçš„è¿›ç¨‹ï¼Œç„¶åå®ç° <code class="language-text">performUnitOfWork</code> å‡½æ•°ï¼Œå¤„ç†å½“å‰å•å…ƒçš„æ¸²æŸ“è¿›ç¨‹ï¼Œå¹¶è¿”å›ä¸‹ä¸€ä¸ªå•å…ƒçš„è¿›ç¨‹ã€‚</p>
<h2 id="fibers" style="position:relative;"><a href="#fibers" aria-label="fibers permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fibers</h2>
<p>æƒ³è¦ç»„ç»‡æ¸²æŸ“è¿›ç¨‹çš„å„ä¸ªå•å…ƒï¼Œæˆ‘ä»¬éœ€è¦ä¾èµ–çš„æ•°æ®ç»“æ„æ˜¯ fiber æ ‘ã€‚</p>
<p>ä¸€ä¸ª fiber ä»£è¡¨æ¯ä¸€ä¸ªå…ƒç´ ï¼Œè€Œæ¯ä¸€ä¸ª fiber ä¹Ÿæ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå•å…ƒã€‚</p>
<p>ä¸‹é¢çœ‹è¿™ä¸ªä¾‹å­ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦æ¸²æŸ“çš„å…ƒç´ ç±»ä¼¼å¦‚ä¸‹è¿™æ ·, ä»–çš„ fiber æ ‘å°±å¦‚å³å›¾.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx">Didact<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token punctuation">/></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">,</span>
  container
<span class="token punctuation">)</span></code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 774px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/d7e94c6d4027b55b401a631461f32b5b/41d3b/2020-12-25-fiber.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACV0lEQVQ4y4VU53qbMBT1a8S1GUITMB6YeNtJs5o0jZu+/7ucXglDwPH4oQ8NdHTGlTo+kzjVvFBcHJ9rnUtgPT/CD4+hH/DG/PfmhfLQPwNYbTbJEMPxFJq+1SF2s229QKLrK3hMNkAvAFp2i/UOr+97TIp5zVJwDiE48pThbuwjZBz9sAIV5wCFO9nzGQYDCak1AZYMtZEw1JZTibetonVTr7UYtk0X6NGpsYqwLAxMmhLjkqE0MVQcY/cwx9PvLebLyXfAZgiVtD55JKIAWrJajp0P9RCBzpBsfiF9/IRZvyCIdL3eqTo2zflyg4xCsH0/UljeP+D59R3Z7Yx8Em0Vh8QDYVoKa8ndfoinl1cU86XrBwSYEnhezKCzkdscctVI++vb7NeAVupqc0f+ZK7vysAPMBlJKKMJTOJ2ltFBsuXZsf+15G6fYb27x3g6K4s5VEgU2ZArqCShOY5IKozz1IFWzI6Z1gxvSObH339YrLa46QVUNorqTSCOjZNfFS8TyrG1eyJZrrUYNiXf/XykEhm6tD0CWND44fkNybRwm1gygSo28GWC2W6HP/tPTFbrujJqydUJpXdfEiKhkWYDYlJ62CzwkGvnd0gpnwzluLDtdYoihlmuiXXs5ovbDEKVoPb/YwKXb0pgbwpDnglwbQ43RWA4Shzbq4CnXhtOqZqEUuWHUCioUMZOrg1DxgO3djKUU6/NiIr8+WMPkWbwSCYf5FDTNXwRQw9HeNnvYUZ0l31+HdCdSi04hOXmrMQgKmvu4KPXenyvvNgeE988av13wv//qII+XE5so/UAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/blog/static/d7e94c6d4027b55b401a631461f32b5b/8ac56/2020-12-25-fiber.webp 240w,
/blog/static/d7e94c6d4027b55b401a631461f32b5b/d3be9/2020-12-25-fiber.webp 480w,
/blog/static/d7e94c6d4027b55b401a631461f32b5b/9b58d/2020-12-25-fiber.webp 774w"
              sizes="(max-width: 774px) 100vw, 774px"
              type="image/webp"
            />
          <source
            srcset="/blog/static/d7e94c6d4027b55b401a631461f32b5b/8ff5a/2020-12-25-fiber.png 240w,
/blog/static/d7e94c6d4027b55b401a631461f32b5b/e85cb/2020-12-25-fiber.png 480w,
/blog/static/d7e94c6d4027b55b401a631461f32b5b/41d3b/2020-12-25-fiber.png 774w"
            sizes="(max-width: 774px) 100vw, 774px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/blog/static/d7e94c6d4027b55b401a631461f32b5b/41d3b/2020-12-25-fiber.png"
            alt="fiber"
            title="fiber"
            loading="lazy"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>åœ¨ <code class="language-text">render</code> æ–¹æ³•ä¸­ï¼Œ æˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªæ ¹ fiber, ç„¶åå°†å…¶è®¾ç½®ä¸º <code class="language-text">nextUnitOfWork</code> (ä¸‹ä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼‰ã€‚ä¹‹åçš„æµç¨‹åˆ™åœ¨ <code class="language-text">performUnitOfWork</code> (æ‰§è¡Œå½“å‰å·¥ä½œå•å…ƒ)å‡½æ•°ä¸­å®ç°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä¼šé’ˆå¯¹æ¯ä¸€ä¸ª fiber æ‰§è¡Œå¦‚ä¸‹æ“ä½œï¼š</p>
<ol>
<li>å°†å…ƒç´ æ·»åŠ åˆ° DOM ä¸­</li>
<li>ä¸ºå…ƒç´ çš„å­å…ƒç´ åˆ›å»ºå„è‡ªçš„ fiber</li>
<li>è¿”å›ä¸‹ä¸€ä¸ªæ‰§è¡Œå•å…ƒ(éœ€è¦è¢«å¤„ç†çš„ fiber)</li>
</ol>
<p>æˆ‘ä»¬é€‰æ‹© fiber æ•°æ®ç»“æ„çš„åŸå› æ˜¯ä¾¿äºæ‰¾åˆ°ä¸‹ä¸€ä¸ªæ‰§è¡Œå•å…ƒã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ¯ä¸€ä¸ª fiber éƒ½ä¸å®ƒçš„ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œç›¸é‚»çš„å…„å¼ŸèŠ‚ç‚¹å’Œçˆ¶èŠ‚ç‚¹éƒ½å­˜åœ¨å…³è”å…³ç³»çš„åŸå› ã€‚</p>
<p>å½“æˆ‘ä»¬åœ¨<code class="language-text">performUnitOfWork</code> ä¸­åšå¥½å¤„ç† fiber çš„ä»»åŠ¡ä¹‹å,  å¦‚æœè¿™ä¸ª fiber æœ‰ä¸€ä¸ª <code class="language-text">child</code> å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¿™ä¸ªå­èŠ‚ç‚¹å¯¹åº”çš„ fiber å°±æ˜¯ä¸‹ä¸€ä¸ªæ‰§è¡Œå•å…ƒã€‚</p>
<p>åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œ<code class="language-text">h1</code> æ˜¯ <code class="language-text">div</code> ä¹‹åçš„ä¸€ä¸ªæ‰§è¡Œå•å…ƒ ã€‚</p>
<p>å¦‚æœæŸä¸ª fiber æ²¡æœ‰å­èŠ‚ç‚¹çš„è¯ï¼Œé‚£ä¹ˆç´§æ¥çš„æ‰§è¡Œå•å…ƒå°±æ˜¯å…„å¼ŸèŠ‚ç‚¹ã€‚</p>
<p>ä¾‹å­ä¸­ï¼Œfiber <code class="language-text">p</code> æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œå› æ­¤ <code class="language-text">a</code> å°±æ˜¯ä¸‹ä¸€ä¸ªæ‰§è¡Œå•å…ƒã€‚</p>
<p>å¦‚æœ fiber æ—¢æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œä¹Ÿæ²¡æœ‰å…„å¼ŸèŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°±ä¼šå¯»æ‰¾è¯¥ fiber çš„â€å”å”èŠ‚ç‚¹â€ï¼šä¹Ÿå°±æ˜¯çˆ¶èŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œå°±æ¯”å¦‚æˆ‘ä»¬ä¾‹å­ä¸­çš„ <code class="language-text">a</code> å’Œ <code class="language-text">h2</code> ã€‚</p>
<p>å¦‚æœçˆ¶èŠ‚ç‚¹ä¸å­˜åœ¨å…„å¼ŸèŠ‚ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿˜ä¼šä¸æ–­å‘ä¸Šè¿½æº¯ï¼Œå¯»æ‰¾è¿™ç±»èŠ‚ç‚¹ï¼Œç›´åˆ°åˆ°è¾¾æ ¹èŠ‚ç‚¹ä¸ºæ­¢ã€‚åˆ°äº†æ ¹èŠ‚ç‚¹ä¹Ÿæ„å‘³ç€ï¼Œé’ˆå¯¹è¿™æ¬¡æ¸²æŸ“çš„æ‰€æœ‰ç»†åˆ†å•å…ƒå·¥ä½œ, æˆ‘ä»¬å‡å·²å®Œæˆã€‚</p>
<p>ç°åœ¨ä»¥ä»£ç å½¢å¼æ¥å‘ˆç°è¿™ä¸€åˆ‡ã€‚</p>
<p>é¦–å…ˆä» <code class="language-text">render</code> ä¸­åˆ é™¤æ¸²æŸ“çš„ä»£ç , æˆ‘ä»¬å°†å…·ä½“çš„æ¸²æŸ“å·¥ä½œéƒ½äº¤ä»˜ç»™ <code class="language-text">performUnitOfWork</code></p>
<p>å°†åˆ›å»º DOM èŠ‚ç‚¹çš„æ–¹æ³•å°è£…æˆ <code class="language-text">createDom</code>ï¼Œåç»­ä½¿ç”¨ã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">createDOM</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dom <span class="token operator">=</span>
    element<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">"TEXT_ELEMENT"</span>
      <span class="token operator">?</span> document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>
      <span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">isProperty</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=></span> key <span class="token operator">!==</span> <span class="token string">"children"</span><span class="token punctuation">;</span>

  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>props<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>isProperty<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">propName</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      dom<span class="token punctuation">[</span>propName<span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">.</span>props<span class="token punctuation">[</span>propName<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> dom<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>åœ¨ <code class="language-text">render</code> æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ç»™ <code class="language-text">nextUnitOfWork</code> (ä¸‹ä¸€ä¸ªå·¥ä½œå•å…ƒï¼‰èµ‹å€¼ä¸º fiber æ ‘çš„æ ¹èŠ‚ç‚¹ã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  nextUnitOfWork <span class="token operator">=</span> <span class="token punctuation">{</span>
    dom<span class="token operator">:</span> container<span class="token punctuation">,</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>
      children<span class="token operator">:</span> <span class="token punctuation">[</span>element<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>å½“æµè§ˆå™¨å‡†å¤‡å°±ç»ªçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨ <code class="language-text">workLoop</code> æ–¹æ³•ï¼Œäºæ˜¯å°±ä¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹æˆ‘ä»¬çš„æ¸²æŸ“è¿›ç¨‹ã€‚</p>
<p>åœ¨ <code class="language-text">performUnitOfWork</code> æ–¹æ³•ä¸­: </p>
<p>æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹, ç„¶åå°†å…¶æ·»åŠ åˆ° DOM ä¸­ã€‚è¿™ä¸ªæ–°èŠ‚ç‚¹ä¼šå­˜å‚¨åœ¨ <code class="language-text">fiber.dom</code> ä¸­:</p>
<p>ç„¶åé’ˆå¯¹æ¯ä¸€ä¸ªå­å…ƒç´ ï¼Œæˆ‘ä»¬éƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„ fiber ã€‚</p>
<p>ä¹‹åå°†å…¶æ·»åŠ åˆ° fiber æ ‘ä¸­ï¼Œæ ¹æ®æƒ…å†µè®¾ç½®ä¸ºå­èŠ‚ç‚¹æˆ–è€…æ˜¯å…„å¼ŸèŠ‚ç‚¹ã€‚</p>
<p>æœ€åæˆ‘ä»¬å®ç°å¯¹ä¸‹ä¸€ä¸ªå·¥ä½œå•å…ƒçš„æœå¯»å·¥ä½œã€‚é¦–å…ˆæ˜¯å­èŠ‚ç‚¹ï¼Œæ¥ç€æ˜¯å…„å¼ŸèŠ‚ç‚¹ï¼Œç„¶åæ˜¯å”å”èŠ‚ç‚¹ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<p>æœ€åå°±å®ç°äº† <code class="language-text">performUnitOfWork</code> æ–¹æ³•ã€‚ä¸‹é¢æ˜¯å®Œæ•´çš„ä»£ç ï¼š</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">performUnitOfWork</span><span class="token punctuation">(</span><span class="token parameter">fiber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// æ–°å¢ DOM èŠ‚ç‚¹</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fiber<span class="token punctuation">.</span>dom <span class="token operator">=</span> <span class="token function">createDom</span><span class="token punctuation">(</span>fiber<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fiber<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>dom<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
	<span class="token comment">// å¯¹æ¯ä¸€ä¸ª child éƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„ fiber </span>
  <span class="token keyword">const</span> elements <span class="token operator">=</span> fiber<span class="token punctuation">.</span>props<span class="token punctuation">.</span>children
  <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">let</span> prevSibling <span class="token operator">=</span> <span class="token keyword">null</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> elements<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> element <span class="token operator">=</span> elements<span class="token punctuation">[</span>index<span class="token punctuation">]</span>

    <span class="token keyword">const</span> newFiber <span class="token operator">=</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> element<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
      props<span class="token operator">:</span> element<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
      parent<span class="token operator">:</span> fiber<span class="token punctuation">,</span>
      dom<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      fiber<span class="token punctuation">.</span>child <span class="token operator">=</span> newFiber
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      prevSibling<span class="token punctuation">.</span>sibling <span class="token operator">=</span> newFiber
    <span class="token punctuation">}</span>

    prevSibling <span class="token operator">=</span> newFiber
    index<span class="token operator">++</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>child<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fiber<span class="token punctuation">.</span>child
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> nextFiber <span class="token operator">=</span> fiber
  <span class="token keyword">while</span> <span class="token punctuation">(</span>nextFiber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextFiber<span class="token punctuation">.</span>sibling<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> nextFiber<span class="token punctuation">.</span>sibling
    <span class="token punctuation">}</span>
    nextFiber <span class="token operator">=</span> nextFiber<span class="token punctuation">.</span>parent
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="æ¸²æŸ“ä¸æäº¤é˜¶æ®µ-commit" style="position:relative;"><a href="#%E6%B8%B2%E6%9F%93%E4%B8%8E%E6%8F%90%E4%BA%A4%E9%98%B6%E6%AE%B5-commit" aria-label="æ¸²æŸ“ä¸æäº¤é˜¶æ®µ commit permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>æ¸²æŸ“ä¸æäº¤é˜¶æ®µ Commit</h2>
<p>ç°åœ¨æˆ‘ä»¬åˆé‡åˆ°äº†å¦ä¸€ä¸ªé—®é¢˜ã€‚</p>
<p>æ¯å¼€å§‹å¤„ç†ä¸€ä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹åˆ° DOM ä¸­ã€‚ä½†æ˜¯æ ¹æ®ç›®å‰çš„ä»£ç å®ç°, åœ¨æ•´æ£µæ ‘åœ¨ DOM ä¸­æ¸²æŸ“å®Œæˆä¹‹å‰ï¼Œæµè§ˆå™¨æ˜¯æœ‰æœºä¼šé˜»ç¢æˆ‘ä»¬æ¸²æŸ“æµç¨‹çš„è¿›è¡Œçš„ã€‚è¿™æ ·çš„è¯ï¼Œç”¨æˆ·å°±å¾ˆå¯èƒ½ä¼šåœ¨æ­¤è¿‡ç¨‹ä¸­çœ‹è§ä¸€ä¸ªä¸å®Œæ•´çš„ UI ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æ‰€æœŸå¾…çš„è¡Œä¸ºã€‚</p>
<p>å› æ­¤æˆ‘ä»¬è¦æŠŠå¼•èµ· DOM å˜åŒ–éƒ¨åˆ†çš„ä»£ç ç§»é™¤ã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token operator">~</span><span class="token operator">~</span><span class="token keyword">if</span> <span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fiber<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>dom<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token operator">~</span><span class="token operator">~</span></code></pre></div>
<p>åŒæ—¶ï¼Œè¦å¼€å§‹ç›‘è§† fiber æ ‘æ ¹èŠ‚ç‚¹çš„å˜åŒ–ã€‚æˆ‘ä»¬å°†ç›‘è§†å˜åŒ–çš„èŠ‚ç‚¹å«åš <code class="language-text">wipRoot</code> ã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  wipRoot <span class="token operator">=</span> <span class="token punctuation">{</span>
    dom<span class="token operator">:</span> container<span class="token punctuation">,</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>
      children<span class="token operator">:</span> <span class="token punctuation">[</span>element<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  nextUnitOfWork <span class="token operator">=</span> wipRoot
<span class="token punctuation">}</span>

<span class="token keyword">let</span> nextUnitOfWork <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">let</span> wipRoot <span class="token operator">=</span> <span class="token keyword">null</span>

	<span class="token keyword">function</span> <span class="token function">workLoop</span><span class="token punctuation">(</span><span class="token parameter">deadline</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// è§ä¸Š</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>ä¸€æ—¦æ‰€æœ‰å·¥ä½œå®Œæˆä¹‹åï¼ˆå½“æ²¡æœ‰ä¸‹ä¸€ä¸ªå·¥ä½œå•å…ƒçš„æ—¶å€™ï¼Œå°±è¡¨ç¤ºæ‰€æœ‰å·¥ä½œéƒ½å®Œæˆäº†ï¼‰ï¼Œå†å°†æœ€ç»ˆçš„ fiber æ ‘äº¤ç»™ DOMã€‚</p>
<p>è¿™éƒ¨åˆ†çš„å·¥ä½œï¼Œäº¤ç»™ <code class="language-text">commitRoot</code> å‡½æ•°æ¥å®Œæˆã€‚åœ¨è¿™é‡Œæˆ‘ä»¬é€’å½’åœ°å°†æ‰€æœ‰èŠ‚ç‚¹æ·»åŠ åˆ° DOM ä¸­ã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">commitRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">commitWork</span><span class="token punctuation">(</span>wipRoot<span class="token punctuation">.</span>child<span class="token punctuation">)</span>
  wipRoot <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">commitWork</span><span class="token punctuation">(</span><span class="token parameter">fiber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fiber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> domParent <span class="token operator">=</span> fiber<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>dom
  domParent<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span>
  <span class="token function">commitWork</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>child<span class="token punctuation">)</span>
  <span class="token function">commitWork</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>sibling<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="åè°ƒ-reconciliation" style="position:relative;"><a href="#%E5%8D%8F%E8%B0%83-reconciliation" aria-label="åè°ƒ reconciliation permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>åè°ƒ Reconciliation</h2>
<p>æˆªæ­¢ç›®å‰ï¼Œæˆ‘ä»¬ä¾ç„¶åªæ˜¯ç®€å•åœ°æ·»åŠ èŠ‚ç‚¹åˆ° DOM ä¸­ï¼Œé‚£ä¹ˆæ›´æ–°å’Œåˆ é™¤ DOM èŠ‚ç‚¹éœ€è¦æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p>
<p>æ¥ä¸‹æ¥è¦å¼€å§‹è¿™éƒ¨åˆ†çš„å¤„ç†ï¼Œæˆ‘ä»¬è¦å¯¹åœ¨ <code class="language-text">render</code> æ–¹æ³•ä¸­è·å–åˆ°çš„ fiber æ ‘ï¼Œä¸å‰ä¸€æ¬¡å·²ç»æ’å…¥åˆ° DOM ä¸­çš„ fiber æ ‘è¿›è¡Œå¯¹æ¯”ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ fiber æ ‘åœ¨è¢«æ’å…¥ DOM ä¸­ä¹‹å‰ï¼ŒæŠŠå®ƒç¼“å­˜ä¸‹æ¥ï¼Œä½œä¸ºå¯¹æ¯”çš„å¯¹è±¡ï¼Œæˆ‘ä»¬æŠŠå®ƒå«åšï¼š<code class="language-text">currentRoot</code> </p>
<p>å¯¹äºæ¯ä¸€ä¸ª fiberï¼Œæˆ‘ä»¬è¿˜ä¼šæ·»åŠ ä¸€ä¸ªå±æ€§ï¼š<code class="language-text">alternate</code> ï¼Œå®ƒæ˜¯ä¸æ—§ç‰ˆæœ¬ fiber çš„è¿æ¥ï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰ç¼“å­˜ä¸‹æ¥çš„å‰ä¸€ä¸ªç‰ˆæœ¬çš„ fiber æ ‘ä¸­çš„å†…å®¹ã€‚</p>
<p>ç°åœ¨å°† <code class="language-text">performUnitOfWork</code> æ–¹æ³•ä¸­åˆ›å»ºæ–° fiber çš„ä»£ç æå–å‡ºæ¥ï¼Œæ·»åŠ åˆ°ä¸€ä¸ªåä¸º <code class="language-text">reconcileChildren</code> æ–¹æ³•ä¸­ã€‚</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">performUnitOfWork</span><span class="token punctuation">(</span><span class="token parameter">fiber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fiber<span class="token punctuation">.</span>dom <span class="token operator">=</span> <span class="token function">createDom</span><span class="token punctuation">(</span>fiber<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> elements <span class="token operator">=</span> fiber<span class="token punctuation">.</span>props<span class="token punctuation">.</span>children
  <span class="token function">reconcileChildren</span><span class="token punctuation">(</span>fiber<span class="token punctuation">,</span> elements<span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>child<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fiber<span class="token punctuation">.</span>child
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> nextFiber <span class="token operator">=</span> fiber
  <span class="token keyword">while</span> <span class="token punctuation">(</span>nextFiber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextFiber<span class="token punctuation">.</span>sibling<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> nextFiber<span class="token punctuation">.</span>sibling
    <span class="token punctuation">}</span>
    nextFiber <span class="token operator">=</span> nextFiber<span class="token punctuation">.</span>parent
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>ç„¶åæˆ‘ä»¬å¼€å§‹å¤„ç†æ—§çš„ fiber å’Œæ–°çš„å…ƒç´ ä»¬ã€‚</p>
<p>åŒæ—¶å¯¹æ—§ fiber çš„å­èŠ‚ç‚¹ä»¬ï¼ˆ<code class="language-text">wipFiber.alternate</code>ï¼‰å’Œæ–°å…ƒç´ çš„æ•°ç»„è¿›è¡Œå¾ªç¯éå†çš„æ“ä½œã€‚</p>
<p>å¦‚æœæˆ‘ä»¬å¿½ç•¥æ‰€æœ‰è¿›è¡Œå¾ªç¯éå†çš„æ ·æ¿ä»£ç ï¼Œä¼šå‘ç°åœ¨å¾ªç¯ä¸­æœ€é‡è¦çš„å†…å®¹æ˜¯ <code class="language-text">oldFiber</code> å’Œ <code class="language-text">element</code> ã€‚<code class="language-text">**element</code> æ˜¯æˆ‘ä»¬å¸Œæœ›æ¸²æŸ“åˆ° DOM ä¸­çš„å†…å®¹ï¼Œ<code class="language-text">oldFiber</code> æ˜¯å‰ä¸€æ¬¡æ¸²æŸ“çš„ fiber æ ‘ã€‚**</p>
<p>æˆ‘ä»¬éœ€è¦å¯¹å®ƒä»¬è¿›è¡Œå¯¹æ¯”, ä»¥ç¡®å®šæˆ‘ä»¬æ˜¯å¦éœ€è¦å¯¹ DOM åšå‡ºä»»ä½•ä¿®æ”¹çš„æ“ä½œ.</p>
<p>å…·ä½“æ–¹å¼æ˜¯å¯¹æ¯”ç±»å‹:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> sameType <span class="token operator">=</span> oldFiber <span class="token operator">&amp;&amp;</span> element <span class="token operator">&amp;&amp;</span> element<span class="token punctuation">.</span>type <span class="token operator">==</span> oldFiber<span class="token punctuation">.</span>type<span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>sameType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO update the node</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>element <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>sameType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO add this node</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>oldFiber <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>sameType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TODO delete the oldFiber's node</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>å¦‚æœæ—§çš„ fiber å’Œæ–°çš„å…ƒç´ ç±»å‹æ˜¯ä¸€æ ·çš„, æˆ‘ä»¬å°±ä¿æŒåŸå…ˆçš„ DOM èŠ‚ç‚¹, ç›´æ¥ä½¿ç”¨æ–°çš„ props æ›´æ–°.</li>
<li>å¦‚æœä¸¤ä¸ªç±»å‹ä¸ä¸€è‡´, å¹¶ä¸”æœ‰æ–°çš„å…ƒç´ å‡ºç°, é‚£ä¹ˆæˆ‘ä»¬å°±è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ DOM èŠ‚ç‚¹.</li>
<li>å¦‚æœä¸¤ä¸ªç±»å‹ä¸ä¸€è‡´, ä½†æ˜¯æ—§çš„ filber ä¾ç„¶å­˜åœ¨, é‚£ä¹ˆæˆ‘ä»¬å°±è¦ç§»é™¤æ—§æœ‰èŠ‚ç‚¹.</li>
</ul>
<p>åœ¨è¿™é‡Œ, React è¿˜ä½¿ç”¨äº† key ä»¥æ›´å¥½åœ°å®ç°åè°ƒ. ä¸¾ä¸ªä¾‹å­, å½“å…ƒç´ çš„å­å…ƒç´ åœ¨å…ƒç´ æ•°ç»„ä¸­æ”¹å˜ä½ç½®æ—¶, ä¹Ÿä¼šè¢«æ£€æµ‹åˆ°.</p>
<p>å½“æ—§çš„ fiber ä¸æ–°çš„å…ƒç´ ç±»å‹ä¸€è‡´æ—¶, æˆ‘ä»¬å¼€å§‹åˆ›å»ºä¸€ä¸ªæ–°çš„ fiber æ¥éš”ç¦» DOM èŠ‚ç‚¹ä¸æ—§çš„ fiber, ä»¥åŠå…ƒç´ ä¸­ä¼ ä¸‹æ¥çš„ props.</p>
<p>ä¸æ­¤åŒæ—¶, æˆ‘ä»¬è¿˜ä¼šç»™ fiber æ·»åŠ ä¸€ä¸ªæ–°çš„å±æ€§: <code class="language-text">effectTag</code> , åœ¨æäº¤é˜¶æ®µä½¿ç”¨:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">if</span> <span class="token punctuation">(</span>sameType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  newFiber <span class="token operator">=</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> oldFiber<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
    props<span class="token operator">:</span> element<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
    dom<span class="token operator">:</span> oldFiber<span class="token punctuation">.</span>dom<span class="token punctuation">,</span>
    parent<span class="token operator">:</span> wipFiber<span class="token punctuation">,</span>
    alternate<span class="token operator">:</span> oldFiber<span class="token punctuation">,</span>
    effectTag<span class="token operator">:</span> <span class="token string">"UPDATE"</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>å¯¹äºéœ€è¦ä¸€ä¸ªæ–° DOM èŠ‚ç‚¹çš„æƒ…å†µ, æˆ‘ä»¬å°† <code class="language-text">effectTag</code> çš„å€¼è®¾ä¸º <code class="language-text">PLACEMENT</code></p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">if</span> <span class="token punctuation">(</span>element <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>sameType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  newFiber <span class="token operator">=</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> element<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
    props<span class="token operator">:</span> element<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
    dom<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    parent<span class="token operator">:</span> wipFiber<span class="token punctuation">,</span>
    alternate<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    effectTag<span class="token operator">:</span> <span class="token string">"PLACEMENT"</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>ç„¶åæ˜¯éœ€è¦åˆ é™¤ DOM èŠ‚ç‚¹çš„æƒ…å†µ, æˆ‘ä»¬ä¸éœ€è¦åˆ›å»ºæ–° fiber, åªéœ€è¦å°†å€¼ä¸º <code class="language-text">DELETION</code> çš„ <code class="language-text">effectTag</code> å±æ€§æ·»åŠ åˆ°æ—§çš„ fiber ä¸Šå³å¯.</p>
<p>ä¸è¿‡å½“æˆ‘ä»¬å°†è¿™ä¸ª fiber æ ‘æäº¤ç»™ DOM æ—¶, éœ€è¦é€šè¿‡ work in progress èŠ‚ç‚¹ (<code class="language-text">wipRoot</code>), å…¶ä¸­ä¸åŒ…å«æ—§çš„ fibers.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">if</span> <span class="token punctuation">(</span>oldFiber <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>sameType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  oldFiber<span class="token punctuation">.</span>effectTag <span class="token operator">=</span> <span class="token string">"DELETION"</span><span class="token punctuation">;</span>
  deletions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>oldFiber<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>å› æ­¤æˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨éœ€è¦è¢«åˆ é™¤çš„ fibers.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  wipRoot <span class="token operator">=</span> <span class="token punctuation">{</span>
    dom<span class="token operator">:</span> container<span class="token punctuation">,</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>
      children<span class="token operator">:</span> <span class="token punctuation">[</span>element<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    alternate<span class="token operator">:</span> currentRoot<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  deletions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  nextUnitOfWork <span class="token operator">=</span> wipRoot
<span class="token punctuation">}</span>

<span class="token keyword">let</span> nextUnitOfWork <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">let</span> currentRoot <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">let</span> wipRoot <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">let</span> deletions <span class="token operator">=</span> <span class="token keyword">null</span></code></pre></div>
<p>å½“æˆ‘ä»¬å°†æ”¹åŠ¨æäº¤ç»™ DOM æ—¶, æˆ‘ä»¬éœ€è¦çš„å°±æ˜¯ä»¥ä¸Šæ•°ç»„ä¸­çš„ fibers.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">commitRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  deletions<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>commitWork<span class="token punctuation">)</span>
  <span class="token function">commitWork</span><span class="token punctuation">(</span>wipRoot<span class="token punctuation">.</span>child<span class="token punctuation">)</span>
  currentRoot <span class="token operator">=</span> wipRoot
  wipRoot <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span></code></pre></div>
<p>ç°åœ¨æˆ‘ä»¬å¼€å§‹ä¿®æ”¹ <code class="language-text">commitWork</code> å‡½æ•°ä»¥å¤„ç†è¿™äº›æ–°çš„ <code class="language-text">effectTag</code>.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">commitWork</span><span class="token punctuation">(</span><span class="token parameter">fiber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fiber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> domParent <span class="token operator">=</span> fiber<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>dom
  domParent<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span>
  <span class="token function">commitWork</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>child<span class="token punctuation">)</span>
  <span class="token function">commitWork</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>sibling<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>å¦‚æœ fiber çš„ effectTag å±æ€§å€¼ä¸º <code class="language-text">PLACEMENT</code>, æˆ‘ä»¬è¿˜æ˜¯æ‰§è¡ŒåŒæ ·çš„æ“ä½œ, å°† DOM èŠ‚ç‚¹æ·»åŠ åˆ°çˆ¶ fiber å¯¹åº”çš„èŠ‚ç‚¹ä¸­,</p>
<p>å¦‚æœæ˜¯ <code class="language-text">DELETION</code> çš„è¯, åˆ™åˆ é™¤è¿™ä¸ªå­èŠ‚ç‚¹.</p>
<p>å¦‚æœæ˜¯ <code class="language-text">UPDATE</code> çš„è¯, åˆ™æ›´æ–°å·²å­˜åœ¨çš„ DOM èŠ‚ç‚¹, åŒæ—¶æ›´æ–° props, å…·ä½“çš„æ“ä½œåœ¨ <code class="language-text">updateDom</code> æ–¹æ³•ä¸­å®ç°</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">commitWork</span><span class="token punctuation">(</span><span class="token parameter">fiber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fiber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> domParent <span class="token operator">=</span> fiber<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>dom<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>effectTag <span class="token operator">===</span> <span class="token string">"PLACEMENT"</span> <span class="token operator">&amp;&amp;</span> fiber<span class="token punctuation">.</span>dom <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    domParent<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>effectTag <span class="token operator">===</span> <span class="token string">"UPDATE"</span> <span class="token operator">&amp;&amp;</span> fiber<span class="token punctuation">.</span>dom <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">updateDom</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">,</span> fiber<span class="token punctuation">.</span>alternate<span class="token punctuation">.</span>props<span class="token punctuation">,</span> fiber<span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>effectTag <span class="token operator">===</span> <span class="token string">"DELETION"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    domParent<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">commitWork</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">commitWork</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>sibling<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">updateDom</code> ä¸­, æˆ‘ä»¬å¯¹æ¯”æ–°æ—§ fiber ä¸­çš„ props, ç§»é™¤å·²ç»ä¸å­˜åœ¨çš„ props, æ›´æ–°æ–°å»ºçš„æˆ–è€…æ˜¯å·²ç»æ”¹å˜çš„ props.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">isProperty</span> <span class="token operator">=</span> <span class="token parameter">key</span> <span class="token operator">=></span> key <span class="token operator">!==</span> <span class="token string">"children"</span>
<span class="token keyword">const</span> <span class="token function-variable function">isNew</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token parameter">key</span> <span class="token operator">=></span>
  prev<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">!==</span> next<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
<span class="token keyword">const</span> <span class="token function-variable function">isGone</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token parameter">key</span> <span class="token operator">=></span> <span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> next<span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">updateDom</span><span class="token punctuation">(</span><span class="token parameter">dom<span class="token punctuation">,</span> prevProps<span class="token punctuation">,</span> nextProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Remove old properties</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>isProperty<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">isGone</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> nextProps<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">name</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      dom<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// Set new or changed properties</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>isProperty<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">isNew</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> nextProps<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">name</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      dom<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> nextProps<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>å…¶ä¸­æœ‰ä¸€ç±» prop æ¯”è¾ƒç‰¹æ®Š, å°±æ˜¯äº‹ä»¶å¤„ç†å™¨, æˆ‘ä»¬é€šè¿‡ prop åä¸­æ˜¯å¦å«æœ‰ <code class="language-text">on</code> å‰ç¼€æ¥åˆ¤æ–­æ˜¯å¦æ˜¯è¿™ç±» prop.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">isEvent</span> <span class="token operator">=</span> <span class="token parameter">key</span> <span class="token operator">=></span> key<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"on"</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">isProperty</span> <span class="token operator">=</span> <span class="token parameter">key</span> <span class="token operator">=></span>
  key <span class="token operator">!==</span> <span class="token string">"children"</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isEvent</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span></code></pre></div>
<p>å¦‚æœäº‹ä»¶å¤„ç†å‡½æ•°æœ‰ä»»ä½•å˜åŒ–, æˆ‘ä»¬å°±ä»æ—§çš„èŠ‚ç‚¹ä¸­åˆ é™¤å®ƒ</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">//Remove old or changed event listeners</span>
Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>isEvent<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=></span> <span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> nextProps<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isNew</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> nextProps<span class="token punctuation">)</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">name</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> eventType <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dom<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span>eventType<span class="token punctuation">,</span> prevProps<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>åŒæ—¶æ·»åŠ ä¿®æ”¹åçš„äº‹ä»¶å¤„ç†å‡½æ•°:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// Add event listeners</span>
Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>isEvent<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">isNew</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> nextProps<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">name</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> eventType <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>eventType<span class="token punctuation">,</span> nextProps<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>å«æœ‰åè°ƒåŠŸèƒ½çš„ react å®ç°å®Œæ•´ä»£ç : <a href="https://github.com/icyfish/didact/blob/master/src/index_v2.jsx" target="_blank" rel="nofollow noopener noreferrer">React With Reconcilation</a></p>
<h2 id="å‡½æ•°å¼ç»„ä»¶" style="position:relative;"><a href="#%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BB%84%E4%BB%B6" aria-label="å‡½æ•°å¼ç»„ä»¶ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>å‡½æ•°å¼ç»„ä»¶</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„æ˜¯æ”¯æŒå‡½æ•°ç»„ä»¶.</p>
<p>é¦–å…ˆä¿®æ”¹ç¤ºä¾‹. æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å‡½æ•°å¼ç»„ä»¶, å®ƒè¿”å›ä¸€ä¸ª <code class="language-text">h1</code> å…ƒç´ .</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">/** @jsx Didact.createElement */</span>
<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Hi </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">App</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>foo<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
<span class="token keyword">const</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span>
Didact<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> container<span class="token punctuation">)</span></code></pre></div>
<p>å°† jsx è½¬æ¢æˆ js çš„è¯, å°±æ˜¯è¿™æ ·:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Didact<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>
    <span class="token string">"h1"</span><span class="token punctuation">,</span>
    <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token string">"Hi "</span><span class="token punctuation">,</span>
    props<span class="token punctuation">.</span>name
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> element <span class="token operator">=</span> Didact<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>App<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"foo"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>å‡½æ•°å¼ç»„ä»¶åœ¨ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢ä¸æ™®é€šç»„ä»¶æœ‰æ‰€åŒºåˆ«:</p>
<ul>
<li>å‡½æ•°å¼ç»„ä»¶çš„ fiber ä¸å­˜åœ¨ DOM èŠ‚ç‚¹.</li>
<li>å®ƒçš„å­å…ƒç´ çš„äº§ç”Ÿæ¥è‡ªäºå‡½æ•°å¼ç»„ä»¶çš„æ‰§è¡Œ, è€Œä¸æ˜¯é€šè¿‡ <code class="language-text">props</code> ä¼ å…¥</li>
</ul>
<p>åœ¨ <code class="language-text">performUnitOfWork</code> å‡½æ•°ä¸­, æˆ‘ä»¬æ£€æŸ¥ fiber çš„ç±»å‹æ˜¯å¦æ˜¯å‡½æ•°, æ ¹æ®ç»“æœæ‰§è¡Œä¸åŒçš„æ›´æ–°æ“ä½œ.</p>
<p>æ‹†åˆ†å‡ºå‡½æ•°å¼ç»„ä»¶çš„å¤„ç†æ–¹æ³• <code class="language-text">updateHostComponent</code> å’Œæ™®é€šç»„ä»¶ çš„å¤„ç†æ–¹æ³•<code class="language-text">updateHostComponent</code>.</p>
<p><code class="language-text">updateHostComponent</code> æ‰€åšçš„å·¥ä½œä¸åŸæ¥ä¸€è‡´:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">updateHostComponent</span><span class="token punctuation">(</span><span class="token parameter">fiber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fiber<span class="token punctuation">.</span>dom <span class="token operator">=</span> <span class="token function">createDom</span><span class="token punctuation">(</span>fiber<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">reconcileChildren</span><span class="token punctuation">(</span>fiber<span class="token punctuation">,</span> fiber<span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>åœ¨ <code class="language-text">updateFunctionComponent</code> ä¸­, æˆ‘ä»¬æ‰§è¡Œè¿™ä¸ªå‡½æ•°ç»„ä»¶ä»¥è·å–å­å…ƒç´ . </p>
<p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­, <code class="language-text">fiber.type</code> çš„å€¼ä¸º <code class="language-text">App</code> å‡½æ•°, æ‰§è¡Œå®ƒæ—¶, ä¼šè¿”å› <code class="language-text">h1</code> å…ƒç´ .</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">updateFunctionComponent</span><span class="token punctuation">(</span><span class="token parameter">fiber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> children <span class="token operator">=</span> <span class="token punctuation">[</span>fiber<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token function">reconcileChildren</span><span class="token punctuation">(</span>fiber<span class="token punctuation">,</span> children<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>è·å–åˆ°å­å…ƒç´ ä¹‹å, åè°ƒçš„å·¥ä½œè¿˜æ˜¯å’Œå‰ä¸€ä¸ªç‰ˆæœ¬æ²¡æœ‰åŒºåˆ«, å› æ­¤ä¸éœ€è¦åšå‡ºä¿®æ”¹.</p>
<p>æ¥ä¸‹æ¥éœ€è¦ä¿®æ”¹çš„æ˜¯ <code class="language-text">commitWork</code> å‡½æ•°.</p>
<p>å¼€å§‹å¤„ç†æ²¡æœ‰ DOM èŠ‚ç‚¹å±æ€§çš„ fibers, éœ€è¦ä¿®æ”¹ä¸¤å¤„:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">commitWork</span><span class="token punctuation">(</span><span class="token parameter">fiber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fiber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> domParent <span class="token operator">=</span> fiber<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>dom
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    fiber<span class="token punctuation">.</span>effectTag <span class="token operator">===</span> <span class="token string">"PLACEMENT"</span> <span class="token operator">&amp;&amp;</span>
    fiber<span class="token punctuation">.</span>dom <span class="token operator">!=</span> <span class="token keyword">null</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    domParent<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>
    fiber<span class="token punctuation">.</span>effectTag <span class="token operator">===</span> <span class="token string">"UPDATE"</span> <span class="token operator">&amp;&amp;</span>
    fiber<span class="token punctuation">.</span>dom <span class="token operator">!=</span> <span class="token keyword">null</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">updateDom</span><span class="token punctuation">(</span>
      fiber<span class="token punctuation">.</span>dom<span class="token punctuation">,</span>
      fiber<span class="token punctuation">.</span>alternate<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
      fiber<span class="token punctuation">.</span>props
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>effectTag <span class="token operator">===</span> <span class="token string">"DELETION"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    domParent<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">commitWork</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>child<span class="token punctuation">)</span>
  <span class="token function">commitWork</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>sibling<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>é¦–å…ˆè¦æ‰¾åˆ° DOM èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹, åœ¨ fiber æ ‘ä¸­ä¸æ–­å‘ä¸Šå¯»æ‰¾ç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå­˜åœ¨ DOM èŠ‚ç‚¹çš„ fiber.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">commitWork</span><span class="token punctuation">(</span><span class="token parameter">fiber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fiber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> domParentFiber <span class="token operator">=</span> fiber<span class="token punctuation">.</span>parent
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>domParentFiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    domParentFiber <span class="token operator">=</span> domParentFiber<span class="token punctuation">.</span>parent
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> domParent <span class="token operator">=</span> domParentFiber<span class="token punctuation">.</span>dom

  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    fiber<span class="token punctuation">.</span>effectTag <span class="token operator">===</span> <span class="token string">"PLACEMENT"</span> <span class="token operator">&amp;&amp;</span>
    fiber<span class="token punctuation">.</span>dom <span class="token operator">!=</span> <span class="token keyword">null</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    domParent<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
	<span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre></div>
<p>åˆ é™¤èŠ‚ç‚¹ä¹Ÿæ˜¯, éœ€è¦ä¸æ–­å¯»æ‰¾çŸ¥é“æ‰¾åˆ°å­˜åœ¨ DOM èŠ‚ç‚¹çš„ fiber.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">commitWork</span><span class="token punctuation">(</span><span class="token parameter">fiber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fiber<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> domParent <span class="token operator">=</span> fiber<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>dom
   <span class="token keyword">if</span><span class="token punctuation">(</span>xxx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// xxx</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>effectTag <span class="token operator">===</span> <span class="token string">"DELETION"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    domParent<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">commitWork</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>child<span class="token punctuation">)</span>
  <span class="token function">commitWork</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>sibling<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">commitDeletion</span><span class="token punctuation">(</span><span class="token parameter">fiber<span class="token punctuation">,</span> domParent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    domParent<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>dom<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">commitDeletion</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>child<span class="token punctuation">,</span> domParent<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="hooks" style="position:relative;"><a href="#hooks" aria-label="hooks permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hooks</h2>
<p>æœ€åä¸€æ­¥æ˜¯å®ç°ä¸ºå‡½æ•°å¼ç»„ä»¶æ·»åŠ çŠ¶æ€. </p>
<p>ç°åœ¨æˆ‘ä»¬å°† app ç¤ºä¾‹è¿›è¡Œä¿®æ”¹, æ”¹ä¸ºä¸€ä¸ªæ¯”è¾ƒç»å…¸çš„è®¡æ•°å™¨åº”ç”¨. æ¯ä¸€æ¬¡ç‚¹å‡»è®¡æ•°å™¨çš„æ•°å€¼å°±ä¼šåŠ ä¸Š1. </p>
<p>æˆ‘ä»¬ä½¿ç”¨ <code class="language-text">Didact.useState</code> æ¥è¯»å–å’Œæ›´æ–°è®¡æ•°å™¨çš„å€¼.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">/** @jsx Didact.createElement */</span>
<span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> Didact<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">c</span> <span class="token operator">=></span> c <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      Count: </span><span class="token punctuation">{</span>state<span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Counter</span></span> <span class="token punctuation">/></span></span></code></pre></div>
<p>æ¥ä¸‹æ¥å¼€å§‹å®ç° <code class="language-text">useState</code> æ–¹æ³•.</p>
<p>åœ¨è°ƒç”¨å‡½æ•°å¼ç»„ä»¶ä¹‹å‰, æˆ‘ä»¬éœ€è¦åˆå§‹åŒ–ä¸€äº›å…¨å±€å˜é‡, ç„¶ååœ¨ <code class="language-text">useState</code> æ–¹æ³•ä¸­ä½¿ç”¨å®ƒä»¬.</p>
<p>é¦–å…ˆæˆ‘ä»¬è®¾ç½®æ­£åœ¨å·¥ä½œçš„ fiber (<code class="language-text">wipFiber</code>). </p>
<p>ä¸ºè¿™ä¸ª filber è®¾ç½® <code class="language-text">hooks</code> å±æ€§ä»¥æ”¯æŒ <code class="language-text">useState</code> åœ¨åŒä¸€ä¸ªç»„ä»¶ä¸­å¤šæ¬¡è¢«è°ƒç”¨, ç”±äºè¢«è°ƒç”¨å¤šæ¬¡, æˆ‘ä»¬è¿˜éœ€è¦å…³æ³¨å½“å‰çš„ hook ç´¢å¼•.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">let</span> wipFiber <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">let</span> hookIndex <span class="token operator">=</span> <span class="token keyword">null</span>

<span class="token keyword">function</span> <span class="token function">updateFunctionComponent</span><span class="token punctuation">(</span><span class="token parameter">fiber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  wipFiber <span class="token operator">=</span> fiber
  hookIndex <span class="token operator">=</span> <span class="token number">0</span>
  wipFiber<span class="token punctuation">.</span>hooks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> children <span class="token operator">=</span> <span class="token punctuation">[</span>fiber<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>fiber<span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token function">reconcileChildren</span><span class="token punctuation">(</span>fiber<span class="token punctuation">,</span> children<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>å½“å‡½æ•°å¼ç»„ä»¶è°ƒç”¨ <code class="language-text">useState</code> æ—¶, æˆ‘ä»¬ä¼šæ£€æŸ¥æ˜¯å¦æœ‰ä¸€ä¸ªæ—§çš„ hook å­˜åœ¨. é€šè¿‡ fiber çš„ <code class="language-text">alternate</code> å’Œ hook ç´¢å¼•å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœ.</p>
<p>å¦‚æœå­˜åœ¨ä¸€ä¸ªæ—§çš„ hook, é‚£ä¹ˆæˆ‘ä»¬å°±ä¼šå°†æ—§ hook æ‰€å­˜å‚¨çš„ state æ‹·è´åˆ°æ–°çš„ hook ä¸­. å¦‚æœä¸å­˜åœ¨çš„è¯, åˆ™åˆå§‹åŒ–ä¸€ä¸ª state.</p>
<p>ç„¶åæ·»åŠ æ–°çš„ hook åˆ° fiber ä¸­, index åŠ ä¸Š1, ç„¶åè¿”å›è¿™ä¸ª state.</p>
<p><code class="language-text">useState</code> åŒæ—¶è¿˜éœ€è¦è¿”å›ä¸€ä¸ªå‡½æ•°, ç”¨ä»¥æ›´æ–° state. äºæ˜¯æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª <code class="language-text">setState</code> æ–¹æ³•. æ¥å—ä¸€ä¸ª action ä½œä¸ºå‚æ•°, åœ¨è®¡æ•°å™¨çš„ä¾‹å­ä¸­, è¿™ä¸ª action æ˜¯æ¯æ¬¡ç‚¹å‡»ä¸ºæ•°å­—çš„å€¼å¢åŠ 1.</p>
<p>æˆ‘ä»¬ç»™ <code class="language-text">hook</code> æ·»åŠ ä¸€ä¸ª é˜Ÿåˆ— <code class="language-text">queue</code> å±æ€§, æ¯æ¬¡ç”¨æˆ·è°ƒç”¨ <code class="language-text">setState</code>, å°±æŠŠè¿™ä¸ª action æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">setState</span> <span class="token operator">=</span> <span class="token parameter">action</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  hook<span class="token punctuation">.</span>queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
  wipRoot <span class="token operator">=</span> <span class="token punctuation">{</span>
    dom<span class="token operator">:</span> currentRoot<span class="token punctuation">.</span>dom<span class="token punctuation">,</span>
    props<span class="token operator">:</span> currentRoot<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
    alternate<span class="token operator">:</span> currentRoot
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  nextUnitOfWork <span class="token operator">=</span> wipRoot<span class="token punctuation">;</span>
  deletions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>å°†è¿™ä¸ª action æ·»åŠ åˆ° <code class="language-text">hook</code> çš„å±æ€§ <code class="language-text">queue</code> ä¸­.</p>
<p>æ¥ä¸‹æ¥åšä¸€äº›ä¸åœ¨ <code class="language-text">render</code> å‡½æ•°ä¸­ç±»ä¼¼çš„äº‹æƒ…. è®¾ç½®ä¸€ä¸ªæ–°çš„è¿½è¸ªèŠ‚ç‚¹(<code class="language-text">wipRoot</code>), åœ¨ä¸‹ä¸€æ¬¡å·¥ä½œè¿›ç¨‹å¼€å§‹æ—¶, å¾ªç¯ä¸­å¯ä»¥å¼€å§‹ä¸€æ¬¡æ–°çš„æ¸²æŸ“æµç¨‹.</p>
<p>æ¥ä¸‹æ¥æ˜¯æ‰§è¡Œ action, åœ¨ä¸‹ä¸€æ¬¡ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶, æˆ‘ä»¬ä¼šä»æ—§çš„ hook é˜Ÿåˆ—ä¸­è¯»å–åˆ°æ‰€æœ‰ action. ä¹‹åæˆ‘ä»¬ä¼šåœ¨æ–°çš„ hook çŠ¶æ€ä¸­ä¸€ä¸€æ‰§è¡Œè¿™äº› action, ç„¶åè¿”å›æœ€æ–°çš„çŠ¶æ€.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token parameter">initial</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> oldHook <span class="token operator">=</span>
    wipFiber<span class="token punctuation">.</span>alternate <span class="token operator">&amp;&amp;</span>
    wipFiber<span class="token punctuation">.</span>alternate<span class="token punctuation">.</span>hooks <span class="token operator">&amp;&amp;</span>
    wipFiber<span class="token punctuation">.</span>alternate<span class="token punctuation">.</span>hooks<span class="token punctuation">[</span>hookIndex<span class="token punctuation">]</span>
  <span class="token keyword">const</span> hook <span class="token operator">=</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> oldHook <span class="token operator">?</span> oldHook<span class="token punctuation">.</span>state <span class="token operator">:</span> initial<span class="token punctuation">,</span>
    queue<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>

	<span class="token keyword">const</span> actions <span class="token operator">=</span> oldHook <span class="token operator">?</span> oldHook<span class="token punctuation">.</span>queue <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  actions<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">action</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    hook<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token function">action</span><span class="token punctuation">(</span>hook<span class="token punctuation">.</span>state<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token function-variable function">setState</span> <span class="token operator">=</span> <span class="token parameter">action</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    hook<span class="token punctuation">.</span>queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
    wipRoot <span class="token operator">=</span> <span class="token punctuation">{</span>
      dom<span class="token operator">:</span> currentRoot<span class="token punctuation">.</span>dom<span class="token punctuation">,</span>
      props<span class="token operator">:</span> currentRoot<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
      alternate<span class="token operator">:</span> currentRoot<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    nextUnitOfWork <span class="token operator">=</span> wipRoot
    deletions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>

  wipFiber<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>hook<span class="token punctuation">)</span>
  hookIndex<span class="token operator">++</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>hook<span class="token punctuation">.</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></div>
<p>æœ€ç»ˆç‰ˆæœ¬çš„ä»£ç : <a href="https://codesandbox.io/s/didact-8-21ost" target="_blank" rel="nofollow noopener noreferrer">React With Hooks</a></p>
<h2 id="åè®°" style="position:relative;"><a href="#%E5%90%8E%E8%AE%B0" aria-label="åè®° permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>åè®°</h2>
<p>è¿™ç¯‡æ–‡ç« é™¤äº†å¸®åŠ©å¤§å®¶ç†è§£ React çš„å®ç°åŸç†ä¹‹å¤–, è¿˜æœ‰ä¸€ä¸ªç›®çš„å°±æ˜¯å¸Œæœ›å¤§å®¶åœ¨é˜…è¯»å®Œä¹‹åèƒ½æ›´å®¹æ˜“åœ°æ¢ç´¢ React æºç . è¿™ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨æ–‡ç« ä¸­ä½¿ç”¨ä¸æºç ä¸€è‡´çš„å˜é‡åå’Œå‡½æ•°åçš„åŸå› .</p>
<p>ä¸¾ä¸ªä¾‹å­, å¦‚æœä½ åœ¨å®é™…çš„ React åº”ç”¨ä¸­, åœ¨å‡½æ•°å¼ç»„ä»¶é‡Œæ·»åŠ æ–­ç‚¹, è°ƒç”¨æ ˆå°±ä¼šæ˜¯å¦‚ä¸‹è¿™æ ·:</p>
<ul>
<li><code class="language-text">workLoop</code></li>
<li><code class="language-text">performUnitOfWork</code></li>
<li><code class="language-text">updateFunctionComponent</code></li>
</ul>
<p>å½“ç„¶, æ•™ç¨‹ä¸­å¹¶æ²¡æœ‰è¦†ç›–åˆ°å…¨éƒ¨çš„ React ç‰¹æ€§ä»¥åŠä¼˜åŒ–ç‚¹. ä¸¾ä¸ªä¾‹å­, ä¸‹é¢æ˜¯ React ä¸æˆ‘ä»¬çš„æºç å®ç°åœ°ä¸åŒçš„åœ°æ–¹:</p>
<ul>
<li>åœ¨ Didact ä¸­, æˆ‘ä»¬åœ¨ <code class="language-text">render</code> é˜¶æ®µéå†äº†æ•´ä¸ªæ ‘. è€Œ React å¹¶ä¸ä¼šè¿™æ ·åš, å½“å­æ ‘æ²¡æœ‰ä»»ä½•å˜åŒ–çš„è¯, æŸäº›ä¸å¿…è¦çš„æ¸²æŸ“æµç¨‹å°±ä¼šè¢«è·³è¿‡.</li>
<li>åŒæ—¶åœ¨æäº¤é˜¶æ®µ, æˆ‘ä»¬ä¹Ÿéå†äº†æ•´ä¸ªæ ‘, è€Œ React åˆ™æ˜¯ç»´æŠ¤äº†ä¸€ä¸ªé“¾è¡¨, åªå…³æ³¨æœ‰ <code class="language-text">effectTag</code> çš„ fiber, åªéå†è¿™äº› fiber.</li>
<li>æ¯æ¬¡æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œèŠ‚ç‚¹æ—¶, éƒ½ä¼šåœ¨æ¯ä¸ª fiber ä¸­åˆ›å»ºæ–°çš„å¯¹è±¡. è€Œ React åˆ™ä¼šä»å…ˆå‰çš„æ ‘ä¸­å›æ”¶è¿™äº› fiber.</li>
<li>å½“ Didact åœ¨ <code class="language-text">render</code> é˜¶æ®µæ‰§è¡Œä¸€æ¬¡æ›´æ–°æ—¶, ä¼šå°†è¿½è¸ªå·¥ä½œæ ‘å®Œå…¨ç§»é™¤, ç„¶åä»æ ¹èŠ‚ç‚¹å†é‡æ–°å¼€å§‹æµç¨‹. è€Œ React çš„æ¯ä¸€ä¸ª tag åˆ™æ˜¯ç»´æŠ¤äº†ä¸€ä¸ªæ—¶é—´æˆ³, æ ¹æ®æ˜¯å¦è¶…æ—¶æ¥ç¡®å®šæ­¤æ¬¡æ›´æ–°çš„ä¼˜å…ˆçº§.</li>
<li>ä»¥åŠæ›´å¤šâ€¦</li>
</ul>
<p>ä½ è¿˜å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ·»åŠ  React ç›¸å…³çš„å…¶ä»–ç‰¹æ€§:</p>
<ul>
<li>å¤„ç†å€¼ä¸ºå¯¹è±¡çš„ <code class="language-text">style</code> å±æ€§</li>
<li><a href="https://github.com/pomber/didact/issues/11" target="_blank" rel="nofollow noopener noreferrer">å®ç°å­å…ƒç´ çš„æ‰å¹³åŒ–</a></li>
<li><code class="language-text">useEffect</code></li>
<li>æ ¹æ® key è¿›è¡Œåè°ƒ</li>
</ul></div></div></div><div class="Post-module--post__footer--3WzWU"><ul class="Tags-module--tags__list--91FqN"><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/blog/tag/react/">React</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/blog/tag/fiber/">Fiber</a></li><li class="Tags-module--tags__list-item--1M30P"><a class="Tags-module--tags__list-item-link--3SL_8" href="/blog/tag/reconciliation/">Reconciliation</a></li></ul></div><div class="Post-module--post__comments--25y6I"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/build-your-own-react";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-8de6de3a6555a9e76093.js"],"app":["/app-7bab443a509de4091087.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-fd4fb51a6fac1c18bdde.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-91533c34d4c04158b3bf.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-9a8ab6a02add1d489a0d.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-e133b6bf534af92835e5.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-ea42bffee1320a898f17.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-9a81f4ebf13f285e62da.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-fabfe238f8e25964e858.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-02327161be6f6fce449d.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-5eb45ea93f9e416dc132.js"]};/*]]>*/</script><script src="/blog/polyfill-8de6de3a6555a9e76093.js" nomodule=""></script><script src="/blog/component---src-templates-post-template-js-fabfe238f8e25964e858.js" async=""></script><script src="/blog/cd95ea5cbd2c605f26db819f07999610c9ff4310-cb79b714c9287bd00e29.js" async=""></script><script src="/blog/styles-407fe62976dc5310c43e.js" async=""></script><script src="/blog/app-7bab443a509de4091087.js" async=""></script><script src="/blog/dc6a8720040df98778fe970bf6c000a41750d3ae-5954f1f1c3eead9a6f74.js" async=""></script><script src="/blog/532a2f07-549094fa347c85980056.js" async=""></script><script src="/blog/framework-1e331b2e9d55ebef6dec.js" async=""></script><script src="/blog/webpack-runtime-210c2a8693fb3712f1d9.js" async=""></script></body></html>