<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:inherit;font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);border-left-color:inherit;opacity:0.8;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:var(--hr);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:var(--textLink);text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}a.anchor{box-shadow:none;}a.anchor svg[aria-hidden="true"]{stroke:var(--textLink);}p code{font-size:1rem;}h1 code, h2 code, h3 code, h4 code, h5 code, h6 code{font-size:inherit;}li code{font-size:1rem;}blockquote.translation{font-size:1em;}</style><style data-href="/blog/styles.e151c0c0c1197749234d.css" id="gatsby-global-css">@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/blog/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/blog/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/blog/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/blog/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/blog/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/blog/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/blog/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/blog/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/blog/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/blog/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/blog/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/blog/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/blog/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/blog/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/blog/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/blog/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/blog/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/blog/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/blog/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/blog/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/blog/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/blog/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/blog/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/blog/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/blog/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/blog/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/blog/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/blog/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/blog/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/blog/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/blog/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/blog/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/blog/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/blog/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/blog/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/blog/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/blog/static/merriweather-latin-300-fc117160c69a8ea0851b26dd14748ee4.woff2) format("woff2"),url(/blog/static/merriweather-latin-300-58b18067ebbd21fda77b67e73c241d3b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/blog/static/merriweather-latin-300italic-fe29961474f8dbf77c0aa7b9a629e4bc.woff2) format("woff2"),url(/blog/static/merriweather-latin-300italic-23c3f1f88683618a4fb8d265d33d383a.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/blog/static/merriweather-latin-400-d9479e8023bef9cbd9bf8d6eabd6bf36.woff2) format("woff2"),url(/blog/static/merriweather-latin-400-040426f99ff6e00b86506452e0d1f10b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/blog/static/merriweather-latin-400italic-2de7bfeaf08fb03d4315d49947f062f7.woff2) format("woff2"),url(/blog/static/merriweather-latin-400italic-79db67aca65f5285964ab332bd65f451.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/blog/static/merriweather-latin-700-4b08e01d805fa35d7bf777f1b24314ae.woff2) format("woff2"),url(/blog/static/merriweather-latin-700-22fb8afba4ab1f093b6ef9e28a9b6e92.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/blog/static/merriweather-latin-700italic-cd92541b177652fffb6e3b952f1c33f1.woff2) format("woff2"),url(/blog/static/merriweather-latin-700italic-f87f3d87cea0dd0979bfc8ac9ea90243.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/blog/static/merriweather-latin-900-f813fc6a4bee46eda5224ac7ebf1b7be.woff2) format("woff2"),url(/blog/static/merriweather-latin-900-5d4e42cb44410674acd99153d57df032.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/blog/static/merriweather-latin-900italic-b7901d85486871c1779c0e93ddd85656.woff2) format("woff2"),url(/blog/static/merriweather-latin-900italic-9647f9fdab98756989a8a5550eb205c3.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto Mono;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_SeW-AJi8SJQtQ4Y.woff) format("woff");unicode-range:U+0460-052f,U+1c80-1c88,U+20b4,U+2de0-2dff,U+a640-a69f,U+fe2e-fe2f}@font-face{font-display:swap;font-family:Roboto Mono;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_QOW-AJi8SJQtQ4Y.woff) format("woff");unicode-range:U+0400-045f,U+0490-0491,U+04b0-04b1,U+2116}@font-face{font-display:swap;font-family:Roboto Mono;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_R-W-AJi8SJQtQ4Y.woff) format("woff");unicode-range:U+0370-03ff}@font-face{font-display:swap;font-family:Roboto Mono;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_S-W-AJi8SJQtQ4Y.woff) format("woff");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01a0-01a1,U+01af-01b0,U+1ea0-1ef9,U+20ab}@font-face{font-display:swap;font-family:Roboto Mono;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_SuW-AJi8SJQtQ4Y.woff) format("woff");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-display:swap;font-family:Roboto Mono;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_ROW-AJi8SJQt.woff) format("woff");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3ik4zwmhdu3cOWxy40.woff2) format("woff2");unicode-range:U+0460-052f,U+1c80-1c88,U+20b4,U+2de0-2dff,U+a640-a69f,U+fe2e-fe2f}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3ik4zwkxdu3cOWxy40.woff2) format("woff2");unicode-range:U+0400-045f,U+0490-0491,U+04b0-04b1,U+2116}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3ik4zwmxdu3cOWxy40.woff2) format("woff2");unicode-range:U+1f??}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3ik4zwlBdu3cOWxy40.woff2) format("woff2");unicode-range:U+0370-03ff}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3ik4zwmBdu3cOWxy40.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01a0-01a1,U+01af-01b0,U+1ea0-1ef9,U+20ab}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3ik4zwmRdu3cOWxy40.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:300;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3ik4zwlxdu3cOWxw.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xK3dSBYKcSV-LCoeQqfX1RYOo3qNa7lujVj9_mf.woff2) format("woff2");unicode-range:U+0460-052f,U+1c80-1c88,U+20b4,U+2de0-2dff,U+a640-a69f,U+fe2e-fe2f}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xK3dSBYKcSV-LCoeQqfX1RYOo3qPK7lujVj9_mf.woff2) format("woff2");unicode-range:U+0400-045f,U+0490-0491,U+04b0-04b1,U+2116}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xK3dSBYKcSV-LCoeQqfX1RYOo3qNK7lujVj9_mf.woff2) format("woff2");unicode-range:U+1f??}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xK3dSBYKcSV-LCoeQqfX1RYOo3qO67lujVj9_mf.woff2) format("woff2");unicode-range:U+0370-03ff}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xK3dSBYKcSV-LCoeQqfX1RYOo3qN67lujVj9_mf.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01a0-01a1,U+01af-01b0,U+1ea0-1ef9,U+20ab}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xK3dSBYKcSV-LCoeQqfX1RYOo3qNq7lujVj9_mf.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xK3dSBYKcSV-LCoeQqfX1RYOo3qOK7lujVj9w.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:600;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwmhdu3cOWxy40.woff2) format("woff2");unicode-range:U+0460-052f,U+1c80-1c88,U+20b4,U+2de0-2dff,U+a640-a69f,U+fe2e-fe2f}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:600;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwkxdu3cOWxy40.woff2) format("woff2");unicode-range:U+0400-045f,U+0490-0491,U+04b0-04b1,U+2116}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:600;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwmxdu3cOWxy40.woff2) format("woff2");unicode-range:U+1f??}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:600;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwlBdu3cOWxy40.woff2) format("woff2");unicode-range:U+0370-03ff}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:600;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwmBdu3cOWxy40.woff2) format("woff2");unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01a0-01a1,U+01af-01b0,U+1ea0-1ef9,U+20ab}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:600;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwmRdu3cOWxy40.woff2) format("woff2");unicode-range:U+0100-024f,U+0259,U+1e??,U+2020,U+20a0-20ab,U+20ad-20cf,U+2113,U+2c60-2c7f,U+a720-a7ff}@font-face{font-display:swap;font-family:Source Sans Pro;font-style:normal;font-weight:600;src:url(https://fonts.gstatic.com/s/sourcesanspro/v14/6xKydSBYKcSV-LCoeQqfX1RYOo3i54rwlxdu3cOWxw.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}html{scroll-behavior:smooth}body{--body-color:#c4b6fd;--font:"Source Sans Pro","Helvetica Neue",Arial,sans-serif;background-color:var(--bg);font-family:var(--font)}body.light{--bg:#fff;--bg-secondary:#f9fafb;--header:var(--body-color);--textNormal:#2c3e50;--textTitle:#2c3e50;--textLink:#a88bfa;--hr:rgba(0,0,0,0.2);--inlineCode-bg:#f8f8f8;--inlineCode-text:#d63200;--form-shadow:0 2px 15px 0 rgba(210,214,220,0.5)}body.dark{-webkit-font-smoothing:antialiased;--bg:#282c35;--bg-secondary:#363c48;--header:#fff;--textNormal:hsla(0,0%,100%,0.88);--textTitle:#fff;--textLink:var(--body-color);--hr:hsla(0,0%,100%,0.2);--inlineCode-bg:#ffe56433;--inlineCode-text:#e6e6e6;--form-shadow:0 2px 15px 0 rgba(26,26,27,0.637)}h1,h2,h3,h4,h5,h6{font-family:var(--font)}a{box-shadow:none;text-decoration:none}a:hover{text-decoration:underline}mark{background:#f59e0b}.title_list{list-style:none}.title_list article section p{color:#8aa4be}.title_list h3{margin-bottom:5px}.title_list a{color:var(--textTitle)}.title_list a:hover{color:var(--textLink);text-decoration:none}.bio-avatar{margin-bottom:20px}code[class*=language-],pre[class*=language-]{font-feature-settings:normal;word-wrap:normal;background:none;color:#fff;font-family:Roboto Mono,Consolas,Menlo,Monaco,source-code-pro,Courier New,monospace;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;margin-bottom:0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{overflow:auto;padding:1.3125rem}pre[class*=language-]::selection{background:#27292a}pre[class*=language-]::selection,pre[class*=language-] ::selection{background:hsla(0,0%,100%,.15);text-shadow:none}:not(pre)>code[class*=language-]{background:var(--inlineCode-bg);border-radius:.3em;color:var(--inlineCode-text);padding:.15em .2em .05em;white-space:normal}.token.attr-name{color:#addb67;font-style:italic}.token.comment{color:#809393}.token.string,.token.url{color:#addb67}.token.variable{color:#d6deeb}.token.number{color:#f78c6c}.token.builtin,.token.char,.token.constant,.token.function{color:#82aaff}.token.punctuation{color:#c792ea}.token.doctype,.token.selector{color:#c792ea;font-style:"italic"}.token.class-name{color:#ffcb8b}.token.keyword,.token.operator,.token.tag{color:#ffa7c4}.token.boolean{color:#ff5874}.token.property{color:#80cbc4}.token.namespace{color:#b2ccd6}pre[data-line]{padding:1em 0 1em 3em;position:relative}.gatsby-highlight-code-line{background-color:#022a4b;border-left:.25em solid #ffa7c4;display:block;padding-left:1.25em;padding-right:1em}.gatsby-highlight,.gatsby-highlight-code-line{margin-left:-1.3125rem;margin-right:-1.3125rem}.gatsby-highlight{-webkit-overflow-scrolling:touch;background:#011627;border-radius:10px;margin-bottom:1.75rem;overflow:auto}@media (max-width:672px){.gatsby-highlight{border-radius:0}}.gatsby-highlight pre[class*=language-]{float:left;min-width:100%}.react-toggle{-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;background-color:transparent;border:0;cursor:pointer;display:inline-block;padding:0;position:relative;touch-action:pan-x;-webkit-user-select:none;-ms-user-select:none;user-select:none}.react-toggle-screenreader-only{clip:rect(0 0 0 0);border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.react-toggle-track{background-color:#0f1114;border-radius:30px;height:24px;padding:0;transition:all .2s ease;width:50px}.react-toggle-track-check{bottom:0;height:17px;left:5px;line-height:0;margin-bottom:auto;margin-top:auto;opacity:0;position:absolute;top:0;transition:opacity .25s ease;width:17px}.react-toggle--checked .react-toggle-track-check,.react-toggle-track-x{opacity:1;transition:opacity .25s ease}.react-toggle-track-x{bottom:0;height:17px;line-height:0;margin-bottom:auto;margin-top:auto;position:absolute;right:5px;top:0;width:17px}.react-toggle--checked .react-toggle-track-x{opacity:0}.react-toggle-thumb{background-color:#fafafa;border-radius:50%;box-sizing:border-box;height:22px;left:1px;position:absolute;top:1px;transform:translateX(0);transition:all .5s cubic-bezier(.23,1,.32,1) 0ms;width:22px}.react-toggle--checked .react-toggle-thumb{border-color:#19ab27;transform:translateX(26px)}.react-toggle--focus .react-toggle-thumb{box-shadow:0 0 2px 3px #c4b6fd}.react-toggle:active .react-toggle-thumb{box-shadow:0 0 5px 5px #c4b6fd}h3.title{margin-bottom:28px;padding-left:15px}ul.table_list{border-radius:.25rem;display:flex;flex-direction:column;left:calc(50% + 400px);margin-bottom:.75rem;margin-top:.75rem;max-height:27rem;max-width:15rem;position:fixed;top:7rem}.table_list li{line-height:1rem;list-style:none;margin-bottom:1em;padding:.25rem}.table_list a{color:var(--color-primary);text-decoration:none}.table_list a.active,.table_list a:hover{color:#a78bfa;text-decoration:none;transition-duration:.3s}.table_list a.active{border-radius:.125rem}.headings{overflow:auto}</style><meta name="generator" content="Gatsby 3.6.1"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml"/><link rel="icon" href="/blog/favicon-32x32.png?v=8f03a5daec1c1aec2f99e70f83851e31" type="image/png"/><link rel="manifest" href="/blog/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#a88bfa"/><link rel="apple-touch-icon" sizes="48x48" href="/blog/icons/icon-48x48.png?v=8f03a5daec1c1aec2f99e70f83851e31"/><link rel="apple-touch-icon" sizes="72x72" href="/blog/icons/icon-72x72.png?v=8f03a5daec1c1aec2f99e70f83851e31"/><link rel="apple-touch-icon" sizes="96x96" href="/blog/icons/icon-96x96.png?v=8f03a5daec1c1aec2f99e70f83851e31"/><link rel="apple-touch-icon" sizes="144x144" href="/blog/icons/icon-144x144.png?v=8f03a5daec1c1aec2f99e70f83851e31"/><link rel="apple-touch-icon" sizes="192x192" href="/blog/icons/icon-192x192.png?v=8f03a5daec1c1aec2f99e70f83851e31"/><link rel="apple-touch-icon" sizes="256x256" href="/blog/icons/icon-256x256.png?v=8f03a5daec1c1aec2f99e70f83851e31"/><link rel="apple-touch-icon" sizes="384x384" href="/blog/icons/icon-384x384.png?v=8f03a5daec1c1aec2f99e70f83851e31"/><link rel="apple-touch-icon" sizes="512x512" href="/blog/icons/icon-512x512.png?v=8f03a5daec1c1aec2f99e70f83851e31"/><title data-react-helmet="true">React DnD 文档翻译 - 教程 | Fish&#x27;s Blog</title><meta data-react-helmet="true" name="theme-color" content="#282c35"/><meta data-react-helmet="true" name="description" content="React DnD Tutorial"/><meta data-react-helmet="true" property="og:title" content="React DnD 文档翻译 - 教程"/><meta data-react-helmet="true" property="og:description" content="React DnD Tutorial"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="icyfish_"/><meta data-react-helmet="true" name="twitter:title" content="React DnD 文档翻译 - 教程"/><meta data-react-helmet="true" name="twitter:description" content="React DnD Tutorial"/><link as="script" rel="preload" href="/blog/webpack-runtime-1c10d4462d6abdb81356.js"/><link as="script" rel="preload" href="/blog/framework-b2b1b62bddbed1246653.js"/><link as="script" rel="preload" href="/blog/app-8cc590526fc91995e11e.js"/><link as="script" rel="preload" href="/blog/commons-ff66217271001e5b3970.js"/><link as="script" rel="preload" href="/blog/component---src-templates-blog-js-40e0ec0461a2aa11ea07.js"/><link as="fetch" rel="preload" href="/blog/page-data/react-dnd-tutorial/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/sq/d/2841359383.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/sq/d/3257411868.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data/app-data.json" crossorigin="anonymous"/></head><body class="light"><script>
              (function() {
                window.__onThemeChange = function() {};
                function setTheme(newTheme) {
                  window.__theme = newTheme;
                  preferredTheme = newTheme;
                  document.body.className = newTheme;
                  window.__onThemeChange(newTheme);
                }

                var preferredTheme;
                try {
                  preferredTheme = localStorage.getItem('theme');
                } catch (err) { }

                window.__setPreferredTheme = function(newTheme) {
                  setTheme(newTheme);
                  try {
                    localStorage.setItem('theme', newTheme);
                  } catch (err) {}
                }

                var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');
                darkQuery.addListener(function(e) {
                  window.__setPreferredTheme(e.matches ? 'dark' : 'light')
                });

                setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'));
              })();
            </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="color:var(--textNormal);background:var(--bg);transition:color 0.2s ease-out, background 0.2s ease-out;min-height:100vh"><div style="margin-left:auto;margin-right:auto;max-width:42rem;padding:2.625rem 1.3125rem"><header style="display:flex;justify-content:space-between;align-items:center;margin-bottom:2.625rem"><h3 style="font-family:Montserrat, sans-serif;margin-top:0;margin-bottom:0;height:42px;line-height:2.625rem"><a style="box-shadow:none;text-decoration:none;color:#c4b6fd" href="/blog/">Fish&#x27;s Blog</a></h3><div style="height:24px"></div></header><ul class="table_list"><h3 class="title">Table of contents</h3><div class="headings"><li style="margin-left:10px"><a href="#设置" class="">设置</a></li><li style="margin-left:10px"><a href="#开始实现游戏" class="">开始实现游戏</a></li><li style="margin-left:20px"><a href="#声明各个组件" class="">声明各个组件</a></li><li style="margin-left:20px"><a href="#创建组件" class="">创建组件</a></li><li style="margin-left:20px"><a href="#添加状态" class="">添加状态</a></li><li style="margin-left:20px"><a href="#设置拖拽上下文" class="">设置拖拽上下文</a></li><li style="margin-left:20px"><a href="#定义拖拽类型" class="">定义拖拽类型</a></li><li style="margin-left:20px"><a href="#实现骑士的可拖拽" class="">实现骑士的可拖拽</a></li><li style="margin-left:20px"><a href="#添加拖拽预览图" class="">添加拖拽预览图</a></li></div></ul><article class="blog-post" itemscope="" itemType="http://schema.org/Article"><header><h1 itemProp="headline">React DnD 文档翻译 - 教程</h1><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem;margin-top:-1.4rem"><p>June 03, 2021<span style="margin-left:10px">☕️☕️☕️☕️ 21 min read</span></p></p></header><section itemProp="articleBody"><p>Tutorial: <a href="https://react-dnd.github.io/react-dnd/docs/tutorial">https://react-dnd.github.io/react-dnd/docs/tutorial</a></p>
<p>想必你已经阅读了概览的章节, 现在开始冒险!</p>
<p><img src="/blog/518c0b3baeae1885f2da3edf518521aa/giphy.gif" alt="giphy.gif"></p>
<p>在本章节的教程中, 我们将使用 React 和 React DnD 实现一个国际象棋游戏. 我当然是在开玩笑! 实现一个规则完备的国际象棋游戏需要花费较大的精力, 同时也超出了本教程的教学范畴. 我们需要做的只是一个<a href="https://react-dnd.github.io/react-dnd/examples/tutorial">简易版的国际象棋游戏, 只有棋盘和一个孤独的骑士</a>. 骑士将会是可拖拽的元素.</p>
<p>如果你已经对 React  很熟悉了, 可以直接跳到最后一节的内容: 添加拖拽交互</p>
<p>在本教程的例子中, 会重点关注 <code class="language-text">react-dnd</code> 数据驱动的哲学. 你会学习到如何创建拖拽元素以及拖拽目标, 如何将两者与你的 React 组件关联, 除此之外, 还有如何根据拖拽的事件改变组件的样式.</p>
<p>那么, 现在就开始吧!</p>
<h1 id="设置" style="position:relative;"><a href="#%E8%AE%BE%E7%BD%AE" aria-label="设置 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>设置</h1>
<p>在本教程中, 代码示例均使用函数组件以及最新的 JavaScript 语法. 因此需要对代码进行编译的处理. 推荐使用: <a href="https://github.com/facebook/create-react-app">create-react-app</a> 这个脚手架.</p>
<p>本教程所实现的<a href="https://react-dnd.github.io/react-dnd/examples/tutorial">最终App Demo</a>.</p>
<h1 id="开始实现游戏" style="position:relative;"><a href="#%E5%BC%80%E5%A7%8B%E5%AE%9E%E7%8E%B0%E6%B8%B8%E6%88%8F" aria-label="开始实现游戏 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>开始实现游戏</h1>
<h2 id="声明各个组件" style="position:relative;"><a href="#%E5%A3%B0%E6%98%8E%E5%90%84%E4%B8%AA%E7%BB%84%E4%BB%B6" aria-label="声明各个组件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>声明各个组件</h2>
<p>首先开始实现我们的 App 所需要的 React 组件, 暂时不要考虑拖拽的交互. 那么我们的孤单骑士应用, 依赖哪些组件呢? 我列举出了一些: </p>
<ul>
<li><code class="language-text">Knight</code> :我们的孤单骑士棋子;</li>
<li><code class="language-text">Square</code> : 棋盘中的格子;</li>
<li><code class="language-text">Board</code>: 含有 64 个格子的棋盘;</li>
</ul>
<p>然后开始考虑这些组件的属性.</p>
<ul>
<li><code class="language-text">Knight</code> : 不需要任何属性. 它始终身处某个位置. 但是骑士本身不需要知道自己所在位置的具体信息, 因为它始终置于某个棋盘格中.</li>
<li><code class="language-text">Square</code> : 或许大家很想要给棋盘格传入位置的属性, 但是实际上它也是不需要这个信息的. 它唯一需要通过属性传入的信息就是棋盘格的颜色. 现在我将 <code class="language-text">Square</code> 的默认颜色值设为白色. 然后为其设置一个属性 black: 它的值是布尔类型. <code class="language-text">Square</code> 接受一个子节点: 当前在其上的棋子. 我选择白色作为默认颜色以匹配浏览器的默认白色.</li>
<li><code class="language-text">Board</code> : 这个组件有点奇怪. 将上面的 <code class="language-text">Square</code> 棋盘格组件作为该组件的子组件, 不太符合常理. 不过除了棋盘格, 棋盘中还包含什么呢? 因此, 或许将棋盘格组件作为该组件的子组件可能是合理的. 再仔细想想, 也许骑士组件也是棋盘 <code class="language-text">Board</code> 组件的子组件, 因为骑士组件是置于棋盘上的. 这就意味着, 棋盘组件需要知道骑士当前所在的位置. 在实际的国际象棋游戏中, 应该存在一类数据结构来描述所有棋子, 包括棋子的颜色和位置. 不过我们的应用不需要这么复杂, 只需要有个 <code class="language-text">knightPosition</code> 属性即可. 我们会用一个存在两个元素的数组来描述骑士(也可以说是各个棋盘格)的位置, 例如: <code class="language-text">[0 , 0]</code> 表示的是 A8 位置. 不过为什么是 A8 而不是 A1 呢? 这是为了配合浏览器的坐标方向. 使用 A1 的时候, 我们的坐标系统会变得极其复杂混乱.</li>
</ul>
<p>接下来的问题是, 当前的状态应该存储在哪里呢? 我不太希望将其放置于 <code class="language-text">Board</code> 组件中. 这里的最佳实践是, 应用依赖的状态, 越小越好, 因为 <code class="language-text">Board</code> 本身已经存在一些位置的逻辑了, 我不希望它再有额外的负担, 还是让其他组件来控制应用的状态吧.</p>
<p>不过好消息是, 现在不需要太在意这些. 我们实现组件的时候, 暂时先假设状态存在于某个位置, 然后确保组件通过属性读取这些状态时渲染正确. 状态管理的问题, 之后再考虑吧!</p>
<h2 id="创建组件" style="position:relative;"><a href="#%E5%88%9B%E5%BB%BA%E7%BB%84%E4%BB%B6" aria-label="创建组件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>创建组件</h2>
<p>在我个人的角度, 更偏爱以自底向上的方式实现应用的功能. 这样的话, 所有新功能的实现都是基于某些功能已实现的前提下的. 如果我先开始实现 <code class="language-text">Board</code> 棋盘组件的话, 那么我就得等到先实现好 <code class="language-text">Square</code> 棋子组件, 这之后才能够看到最终的效果. 而如果是先开始实现 <code class="language-text">Square</code> 棋子组件的话, 则不需要依赖棋盘组件, 就能看到最终效果. 个人认为获取实时反馈是十分重要的. (从我实现的另一个工具: <a href="https://gaearon.github.io/react-hot-loader/">react-hot-loader</a> 也能看出我这个观点.)</p>
<p>因此现在我要开始实现 <code class="language-text">Knight</code> 骑士组件了. 它不接受任何属性, 实现它最简单的方式是:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Knight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token plain-text">♘</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
<span class="token punctuation">}</span></code></pre></div>
<p>♘  是 Unicode 编码形式的骑士! 这太棒了. 我们能够将颜色作为骑士组件的属性, 但是在我们的实际例子中, 只有白色的骑士, 因此可以直接省略这个属性.</p>
<p>看起来正常渲染了, 为了确保渲染正确, 我会修改所渲染的组件来进行测试:  </p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">import</span> Knight <span class="token keyword">from</span> <span class="token string">'./Knight'</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Knight</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/d425a1b08afd1b22516fbc402898086b/2bef9/NktjTMn.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACKklEQVQ4y52RTW8SQRjHZ4HBkxAFErMVOHrw6BfwUBMSm+DRk1dPHOvVhgMXCN/AaD9BrSZeiRdTFkrrVhaKy86yy8sCC64kLbAvPGagpakXF//Jb57JJM8vz8wgAECUp7+J5/U3wM1XIoaLXxgA8OGnQ/zx4AA/297GiUQCJ5NJ/GZ3F+/vv8d7e29xKpXCmUwG5/N5z7UH6QBo6+XzO8rxyYeO8JWvqJWjyskpV+Q4rimKnCiKnKZpXK/X47rdLtdqtbhG4ydHCOEURTmSZZmv1+vvGIbBSyFd2MePIrVSuaGcl4EnPJTKx1AqlUAQBKjVaqBpGui6DoZhwGAwAEmSQFVV6HQ6IIoiFItFgWXZ0FoYvnf/4Vm1etbpDUA8F01FUezLywu70WjYhBBblmV7PB7bpmna8/l8XafTqdlqtaBQKJzGYjEW0VBhPB6PSs2mMJvNwLIsZz6fA92bprnEsqxlped/YTuOQ6fmvV7v1lrIsmy03+8LsIoD7mPTZTQa8X6//0YYCoWi4/F4KVwsFs5isQCXLIW6rvMY4xthOByOjkajW0I3cS10e99/CX8sH9BxLMd9LNozHA6/3xJGIpHoZDIR4T9jGEZ9/Sk0gUCAFQThi6qqHUKIRAiRXSK12+1utVr9zDDMg2sZLUGE0BOE0A5C6MWG7Fz1BoLB4GpCj8fjowcIoTBCKLIhtOfulQMhn29Vc7kcymazTDqd3ohcLkdZP98f/8YKFrHMceYAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="NktjTMn.png"
        title="NktjTMn.png"
        src="/blog/static/d425a1b08afd1b22516fbc402898086b/f058b/NktjTMn.png"
        srcset="/blog/static/d425a1b08afd1b22516fbc402898086b/c26ae/NktjTMn.png 158w,
/blog/static/d425a1b08afd1b22516fbc402898086b/6bdcf/NktjTMn.png 315w,
/blog/static/d425a1b08afd1b22516fbc402898086b/f058b/NktjTMn.png 630w,
/blog/static/d425a1b08afd1b22516fbc402898086b/40601/NktjTMn.png 945w,
/blog/static/d425a1b08afd1b22516fbc402898086b/2bef9/NktjTMn.png 1024w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>每创建一个新的组件我都会进行一次同样的操作, 这样我就能够始终看到新组件的渲染效果. 在大型应用中, 我会使用类似 <a href="https://github.com/skidding/cosmos">cosmos</a>  这类工具来实时观察组件的状态, 这样就能在编写组件时看到实时的反馈.</p>
<p>现在我看到了屏幕上的 <code class="language-text">Knight</code> ! 然后可以开始实现 <code class="language-text">Square</code> 组件了. 这是我的第一步:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Square</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> black <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> fill <span class="token operator">=</span> black <span class="token operator">?</span> <span class="token string">'black'</span> <span class="token operator">:</span> <span class="token string">'white'</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> backgroundColor<span class="token operator">:</span> fill <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>
<span class="token punctuation">}</span></code></pre></div>
<p>现在开始修改入口文件的代码来看看骑士组件在棋盘组件内部的效果:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">import</span> Knight <span class="token keyword">from</span> <span class="token string">'./Knight'</span>
<span class="token keyword">import</span> Square <span class="token keyword">from</span> <span class="token string">'./Square'</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Square</span></span> <span class="token attr-name">black</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Knight</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Square</span></span><span class="token punctuation">></span></span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre></div>
<p>然而屏幕却是空的. 因为我犯了几个错误:</p>
<ul>
<li>我不记得给棋盘组件添加宽高的样式了, 因此它并没有在页面中展示出来. 但是我不希望给棋盘组件固定的尺寸, 因此我设置了这样的属性: <code class="language-text">width: &#39;100%&#39;</code> <code class="language-text">height: &#39;100%&#39;</code> 以撑开容器.</li>
<li>我还忘了在 <code class="language-text">Square</code> 组件中读取 <code class="language-text">{children}</code>, 因此传入其中的 <code class="language-text">Knight</code> 组件被忽略了.</li>
</ul>
<p>可是即使我纠正了这两个错误, 依然没有看到我的 <code class="language-text">Knight</code> 组件, 这是因为<code class="language-text">Knight</code> 组件中的文本默认颜色是黑色, 而棋盘格的背景颜色也是黑色. 我们可以给 <code class="language-text">Knight</code> 加上颜色属性来解决这个问题. 不过更加简单的解决方案是在设置 <code class="language-text">backgroundColor</code> 属性的同时也设置关联的 <code class="language-text">color</code> 样式. 这样修改过之后的版本, 就是我们所预期的结果了.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Square</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> black<span class="token punctuation">,</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> fill <span class="token operator">=</span> black <span class="token operator">?</span> <span class="token string">'black'</span> <span class="token operator">:</span> <span class="token string">'white'</span>
  <span class="token keyword">const</span> stroke <span class="token operator">=</span> black <span class="token operator">?</span> <span class="token string">'white'</span> <span class="token operator">:</span> <span class="token string">'black'</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        backgroundColor<span class="token operator">:</span> fill<span class="token punctuation">,</span>
        color<span class="token operator">:</span> stroke<span class="token punctuation">,</span>
        width<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
        height<span class="token operator">:</span> <span class="token string">'100%'</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/8457ba5fee9bcad4619585a56360b9d7/2bef9/jvgv6DV.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACS0lEQVQ4y6WQTWsaQRyHZ+MOhZa0h22gJPGoh0IvevLWQ4qu7yJCT9WTJQeP9qAHQw5eFL9BSfMJohWKogj1UHVLTLpR8a1xtejWBGOFttB25V9mtQkpgSodePY3O/zmYWYQACDC40ln5fk7wB+ftTF8G2MAwInXCRw/OMBPtrawwWDANpsNv/D78f7+Ht7ZCWGfz4fD4TCOxWIrfzxoBIA2nppudQ+PXvWrb/nyp3Lx8OiYK3Ec1263ZUTxMyeKIjcYDLhut8s1my2u0+mQeVEQBL5er7+kKArLQvLZfPRwrcq9b3aqJSi3ylAocVAoFOGE56FSqUC/34fhcAij0QhEUYRWqwWCIECv14NGowGFQqGmVCqZS+Hq7TubjXbr5Ov3H3A+PP85mUwkAJDOzs6ki4uxNB5/kabTqbz2F6QLpVLpmGGYdUQGEfr9fmUsFquZTSZgWXbKsizo9XoylzEajXIaDIZrsCwrkV4oFOKDweDGpTCbzSrtdnuN/CKEpvNcBImkkTXyuVzuSphOp5UOh0MW0jQ9VSgUsAg0TctCl8vFx+Pxm4UURS19QqfTySeTyf8XUhR1szCVShFhZV76NX/HfzLvEuGHRCJxJczn80TYXuKq13A6nfVMJjMTkrG9vb0eCATemM3mvtVqPbVarcKCnFoslkEwGEx6PJ4HssztdpO4p1artTqdzqzRaOxarXYhSJfsUalUWoTQXa/XOzshwzA0WUAI3UcIrS0J2bM6dyBE07OMRqMoEolQu7u7SxGNRgmXz/cb9CbqeLFD2+4AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="jvgv6DV.png"
        title="jvgv6DV.png"
        src="/blog/static/8457ba5fee9bcad4619585a56360b9d7/f058b/jvgv6DV.png"
        srcset="/blog/static/8457ba5fee9bcad4619585a56360b9d7/c26ae/jvgv6DV.png 158w,
/blog/static/8457ba5fee9bcad4619585a56360b9d7/6bdcf/jvgv6DV.png 315w,
/blog/static/8457ba5fee9bcad4619585a56360b9d7/f058b/jvgv6DV.png 630w,
/blog/static/8457ba5fee9bcad4619585a56360b9d7/40601/jvgv6DV.png 945w,
/blog/static/8457ba5fee9bcad4619585a56360b9d7/2bef9/jvgv6DV.png 1024w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>现在是时候开始实现 <code class="language-text">Board</code> 棋盘组件了! 最初的版本将会是一个很简单的实现, 只会展示一个棋盘格:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> Square <span class="token keyword">from</span> <span class="token string">'./Square'</span>
<span class="token keyword">import</span> Knight <span class="token keyword">from</span> <span class="token string">'./Knight'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Board</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Square</span></span> <span class="token attr-name">black</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Knight</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Square</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>目前我唯一的目标就是让棋盘组件渲染到页面上, 之后再慢慢对其进行优化:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">import</span> Board <span class="token keyword">from</span> <span class="token string">'./Board'</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Board</span></span> <span class="token attr-name">knightPosition</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre></div>
<p>现在已经能看到一个棋盘格在页面中的样子了. 然后要开始加上所有的必要的棋盘格! 可是我还是无从下手. 应该在 <code class="language-text">render</code> 方法中渲染哪些东西呢? <code class="language-text">for</code> 循环某个数据? 还是针对某个数组的 <code class="language-text">map</code> ?</p>
<p>可是我现在暂时不想考虑这些. 我已经知道如何渲染单个棋盘格了, 不管是有骑士或是没有骑士的版本. 通过 <code class="language-text">knightPosition</code> 这个属性, 我还能知道骑士当前的位置. 这意味着我可以开始实现 <code class="language-text">renderSquare</code> (渲染棋盘格) 方法了, 现在先不考虑整个棋盘的渲染, 之后在说.</p>
<p>对于 <code class="language-text">renderSquare</code> 方法, 我的第一想法是: </p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">renderSquare</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token punctuation">[</span>knightX<span class="token punctuation">,</span> knightY<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> black <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> y<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">1</span>
  <span class="token keyword">const</span> isKnightHere <span class="token operator">=</span> knightX <span class="token operator">===</span> x <span class="token operator">&amp;&amp;</span> knightY <span class="token operator">===</span> y
  <span class="token keyword">const</span> piece <span class="token operator">=</span> isKnightHere <span class="token operator">?</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Knight</span></span> <span class="token punctuation">/></span></span> <span class="token operator">:</span> <span class="token keyword">null</span>

  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Square</span></span> <span class="token attr-name">black</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>black<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>piece<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Square</span></span><span class="token punctuation">></span></span>
<span class="token punctuation">}</span></code></pre></div>
<p>可以尝试修改 <code class="language-text">Board</code> 组件, 让它像下面这样渲染:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Board</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> knightPosition <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        width<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
        height<span class="token operator">:</span> <span class="token string">'100%'</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token function">renderSquare</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> knightPosition<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token function">renderSquare</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> knightPosition<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token function">renderSquare</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> knightPosition<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/4d44065784b9e8434cecaa48e46967bb/2bef9/Br30DLg.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACRUlEQVQ4y6XQPWwSYRgH8JfCi5MVhSbmKmWgiQOBkLQ7DjUh0QQn4mTSyalMVEY7dSQ5dqMdbq7VxLVxMeWgtF7tQfHgjiN89g5rm37cF495r5FGXWj9J//3uVzu+eXNIQBApI9+ihMvvwCuvRAwnP7AAIA3Pmzg9+vr+PHCAo7H4ziRSOBXy8t4be0tXll5jZeWlvDq6irOZrMTvx2kAKDp509uyds771r8Z67ULG2VdnbZPMuyNUFgBUFgu90u2+l02Ha7zTYaDbZa/c6KosjKsrwlSRJXqVTeOBwObIPkoEIPp8qFYlU+KAInclAobkOhUACe56FcLkO32wVFUeDo6Aj6/T7U63VoNpvQarVAEATI5/M8RVHeEei7e+/B3v7+XqvTB+FA0GVZNs/OTs1qtWqKomhKkmQOBgNT13VT07TRPD8/1xuNBmxubu7OzMxQiISAgUDAX6/V+IuLCzAMw9I0Dcizrut2DcOwJ3n/V03LssitOafTOT0CKYry93o9Hi5jwfgxyaGqKud2u69Ar9frHwwGNjgcDq3hcAhj1gYVReEwxlegz+fzq6r6BzhOrgX+9w0VRflm/xTTNKwxQ74lO4eHh1//AU9OTgS4YY6Pjysul+sSJInFYhTDMJ9yuVyLpuk6TdPSmK3ncrk2wzAf5+fn749Aj8dzByE0hxB6ihB6ds2SnTmPxzNpY4uLi2S4ZmdnJ6PRqC8UCk1dp2QnGAzeJkYqlUIomUyiTCaDwuEwgR03aSQSQel0GiUSCfQLWBH0U25JrH4AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Br30DLg.png"
        title="Br30DLg.png"
        src="/blog/static/4d44065784b9e8434cecaa48e46967bb/f058b/Br30DLg.png"
        srcset="/blog/static/4d44065784b9e8434cecaa48e46967bb/c26ae/Br30DLg.png 158w,
/blog/static/4d44065784b9e8434cecaa48e46967bb/6bdcf/Br30DLg.png 315w,
/blog/static/4d44065784b9e8434cecaa48e46967bb/f058b/Br30DLg.png 630w,
/blog/static/4d44065784b9e8434cecaa48e46967bb/40601/Br30DLg.png 945w,
/blog/static/4d44065784b9e8434cecaa48e46967bb/2bef9/Br30DLg.png 1024w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>到目前为止, 我还没有给我的棋盘格进行任何的布局处理. 我会使用 <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Basic_Concepts_of_Flexbox">Flexbox</a> 来实现布局. 在根节点 <code class="language-text">div</code> 中, 我加了点样式, 然后将 <code class="language-text">Square</code> 组件加到了 <code class="language-text">div</code> 中, 这样就能够对它们进行布局. 一般来说, 最好是保持组件被完善地封装, 不要被布局所影响, 因此即使在组件内部添加布局性质的 <code class="language-text">div</code> 也是没有问题的.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> Square <span class="token keyword">from</span> <span class="token string">'./Square'</span>
<span class="token keyword">import</span> Knight <span class="token keyword">from</span> <span class="token string">'./Knight'</span>

<span class="token keyword">function</span> <span class="token function">renderSquare</span><span class="token punctuation">(</span><span class="token parameter">i<span class="token punctuation">,</span> <span class="token punctuation">[</span>knightX<span class="token punctuation">,</span> knightY<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> x <span class="token operator">=</span> i <span class="token operator">%</span> <span class="token number">8</span>
  <span class="token keyword">const</span> y <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>i <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> isKnightHere <span class="token operator">=</span> x <span class="token operator">===</span> knightX <span class="token operator">&amp;&amp;</span> y <span class="token operator">===</span> knightY
  <span class="token keyword">const</span> black <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> y<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">1</span>
  <span class="token keyword">const</span> piece <span class="token operator">=</span> isKnightHere <span class="token operator">?</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Knight</span></span> <span class="token punctuation">/></span></span> <span class="token operator">:</span> <span class="token keyword">null</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token operator">:</span> <span class="token string">'12.5%'</span><span class="token punctuation">,</span> height<span class="token operator">:</span> <span class="token string">'12.5%'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Square</span></span> <span class="token attr-name">black</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>black<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>piece<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Square</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Board</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> knightPosition <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> squares <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    squares<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">renderSquare</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> knightPosition<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        width<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
        height<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
        display<span class="token operator">:</span> <span class="token string">'flex'</span><span class="token punctuation">,</span>
        flexWrap<span class="token operator">:</span> <span class="token string">'wrap'</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>squares<span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/4f9250640191a8139bb007a78f95cad9/2bef9/RsQDI4Y.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAADqklEQVQ4y5WSX0hiWRjAj9Vle2mjaYKl8i3oYV+CeakeYk1XowYUitqKzEwzS6GS2SBNyBIqLY3IiNKcIoh6mJ1dCAt62Ie2ujPbtE5jrul2dUYrkP4QRY339i3n7q6xb7sHvnu+c7nn9/3Odw8CAITjm6vjFNUvQISkQQJuLggAIF7/+Jr44dUr4luBgKioqCDEYjHx/YsXxMuXbsJo7CdUKhVhNpsJm82W8g8HxQFQ3ndVX0R+feeO+n727n3c29l7t0/ukiQZCgbJYDBInp6ekicnJ2QsFiPD4TAZCByRFEWRkUhkh6Ior9/vd3I4HIIF4kfu14U5h2/eBiK/v4X90D5s7+zCLkmCz+eDg4MD+BSNQjweh8vLS4jFYnB0FIRIJALhcBj8fj9sb2/7uFxudhL49MmT/PcfPryPfDqB2Mfo57u7O/r+/p4+PDykLy4u6Ovrazoej9OJRIIGADaurq7o29vbzzc3N7j4flZWVi7CgzXMy+VSx8c+AICFhQWmtLQUvF4vXoJWq4X6+no2Pzs7A6FQCIODg+za4/HQfD4fHA6HV61W5yWBJpOJa7FYfCKRCPr7+5mlpSVob28HsVgMdrsdZmZmoLa2Fpqbm8HtdsPw8DBUVlZCT08Pvbi4COvr614ej/cIFIlE3M3NTd/y8jIYDAYGG9lsNsDgjo4OaG1thfn5eZienoampibQ6XSwsrICZrOZbmxshLm5Oa9CoXgEarVartPp9GEDk8nEYAu8qaWlBSYmJlhQW1sbaDQavBlGR0dZsF6vp3Ehj8fjLS8vfwRWVVVxNzY2fNhIr9czdXV1MD4+Dvg4arUa5HI5OJ1O3CvARt3d3YBPMzQ0RDc0NLCGSqXyEdjZ2YkND2QyGQwMDCRcLhej0+kYuVzO2O12xuFwMCqVitFoNMzs7CwzMjLCSKVSpq+vL4ELra2t/fYvw+rqamwYxPpGo5E1GhsbA5fLBV1dXWwf8Y+ZnJwEpVIJvb29+DbgHoJCocC5P2mIh1QqzbVYLGs8Hi+6urr6BwBQBoOBEggEVCAQoM7Pz6mamhpKpVJRDw8P1NbWFlVSUkJNTU3hb2OhUOgnhNBXGRkZCMlkMszMLCgoeCYUCp9nZ2dLEEKSwsJCSVlZGZvjKC4ulhQVFbF5enq6hM/nS/Lz8/H6OULoGULoy6RhZmZm2t8vniKEclJTU3Pw/F+Cw+HgPRkpKSlpLCwt7a/ZarUii8XCMZlM/yusViuOpNyfsjx8KoezCDUAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="RsQDI4Y.png"
        title="RsQDI4Y.png"
        src="/blog/static/4f9250640191a8139bb007a78f95cad9/f058b/RsQDI4Y.png"
        srcset="/blog/static/4f9250640191a8139bb007a78f95cad9/c26ae/RsQDI4Y.png 158w,
/blog/static/4f9250640191a8139bb007a78f95cad9/6bdcf/RsQDI4Y.png 315w,
/blog/static/4f9250640191a8139bb007a78f95cad9/f058b/RsQDI4Y.png 630w,
/blog/static/4f9250640191a8139bb007a78f95cad9/40601/RsQDI4Y.png 945w,
/blog/static/4f9250640191a8139bb007a78f95cad9/2bef9/RsQDI4Y.png 1024w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>现在看起来已经很不错了! 但是我还是不知道如何对 <code class="language-text">Board</code> 进行样式的处理, 使得每一个棋盘格都是正方形, 不过后续添加应该会比较方便.</p>
<p>现在, 我们已经可以修改骑士的位置属性 <code class="language-text">knightPosition</code> 来控制它在棋盘上的位置了:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">import</span> Board <span class="token keyword">from</span> <span class="token string">'./Board'</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Board</span></span> <span class="token attr-name">knightPosition</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/99fad24faa14a7a512c0304d1e6622b6/2bef9/0fNBn5a.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAADrUlEQVQ4y5WRTUhjVxTHb6KPuklFHEs7Y3aC0JUwG3UhjUmDxJEEFD8QY4yJMV8gCaOLxICRgJJoIpKoaDR+LnQxnRb8XHVh1TdTx4kS05i0L7FGheAHouj4nqfcN63SXXvhf+85l3N+9//OQwCAsL67/IOr+QWImDxKwPU5AQDE2x/fEj+8eUN8LxIRZWVlhFQqJdpfvyYmJwOEzdZJaDQawuFwEG63m/sPB6UA0Iva8i8Sv34IHIV+Dm4fbm9uf9ght0iSjEWjZDQaJU9OTsjj42MymUyS8XicjEQOSIqiyEQisUlRVDAcDvs5HA7BAvH2zbf5Ofvv3kcOf3sPO7Ed2Njcgi2ShFAoBHt7e/Dn0RGkUim4uLiAZDIJBwdRSCQSEI/HIRwOw8bGRojP52c/Ar96lpP7cXd3N36YhORh8tPt7S19d3dH7+/v0+fn5/TV1RWdSqXo+/t7GgBYXV5e0jc3N5+ur6/x4ztZWVnPEV4YyOPx+KlUKgQAEJgMMMXFxRAMBnEKRqMR6urq2Pj09BTEYjF0d3ez+fLyMi0UCsHn8wW1Wu2LR2BHRwff6/WGKioqwGq1MrOzs9Da2gpSqRQ8Hg+MjIxAdXU1NDY2QiAQgJ6eHpBIJGAymejp6WlYWVkJCgSCJ6BEIuGvra2F5ubmoLOzk6mtrQW32w0YrNPpoLm5GSYmJmBoaAgaGhrAbDbD/Pw8OBwOur6+HsbGxoIqleoJaDQa+X6/P6RQKMButzPYBW5qamqCgYEBFtTS0gIGgwE3g9PpZMFWq5XGDy0tLQVLS0ufgOXl5fzV1dUQdmSxWJiamhro7+8H/DlarRaUSiX4/X48K8COTCYTzMzM4JzW6/UwPDwc1Ol0T0C9Xo8d7mGHXV1d9+Pj44zZbGaUSiXj8XgYn8/HaDQaxmAwMKOjo0xvby8jl8sZi8WCa2FxcfHjvxxWVlZih1Fs32azsY76+voAF7e1tbFzxD9mcHAQ1Go1tLe3w9TUFJ4hqFQqHIfVavVnIF5yufy50+lcFAgERwsLC78DAGW1WimRSERFIhHq7OyMqqqqojQaDfXw8ECtr69TRUVFlNfrxbXJWCz2E0Loax6Ph5BCocDMzLy8vJdisfhVdna2DCEky8/Pl5WUlLAxVmFhoaygoICNMzIyZEKhUJabm4vzVwihlwihLx8dZmZmpv998QwhlJOWlpaDz/8iDoeDe3hcLjedhaWnfz5dLhdyOp0cu93+v+RyubAezf0FhPV8lgCO9eAAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="0fNBn5a.png"
        title="0fNBn5a.png"
        src="/blog/static/99fad24faa14a7a512c0304d1e6622b6/f058b/0fNBn5a.png"
        srcset="/blog/static/99fad24faa14a7a512c0304d1e6622b6/c26ae/0fNBn5a.png 158w,
/blog/static/99fad24faa14a7a512c0304d1e6622b6/6bdcf/0fNBn5a.png 315w,
/blog/static/99fad24faa14a7a512c0304d1e6622b6/f058b/0fNBn5a.png 630w,
/blog/static/99fad24faa14a7a512c0304d1e6622b6/40601/0fNBn5a.png 945w,
/blog/static/99fad24faa14a7a512c0304d1e6622b6/2bef9/0fNBn5a.png 1024w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>声明式的方式十分令人惊喜! 我想这也是人们喜欢 React 的原因吧.</p>
<h2 id="添加状态" style="position:relative;"><a href="#%E6%B7%BB%E5%8A%A0%E7%8A%B6%E6%80%81" aria-label="添加状态 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>添加状态</h2>
<p>接下来就要进行操作让 <code class="language-text">Knight</code> 组件变成可拖拽组件了. 要达到这个目的, 我们需要将当前骑士的位置保存下来, 然后在有需要的时候修改它的位置.</p>
<p>但是这个状态的设计需要仔细的思考,  我们会先开始设计状态, 之后再考虑拖拽的交互. 因此暂时先用简单的点击事件来替代拖拽. 当用户点击某个棋盘格的时候, 骑士会随之移动到该棋盘格, 移动的规则当然需要严格遵循国际象棋的规范. 实现这部分逻辑能够帮助我们深入了解状态的管理, 完成这一步之后只需要将点击的交互改为拖拽的交互就可以了.</p>
<p>React 不会对用户设计状态或数据流的方案有所限制. 用户可以使用 <a href="https://facebook.github.io/flux/">Flux</a>, <a href="https://github.com/reactjs/react-redux">Redux</a>, <a href="https://github.com/Reactive-Extensions/RxJS">Rx</a> , <del>甚至是 Backbone</del>. 不过一定要注意<a href="https://martinfowler.com/bliki/CQRS.html">避免将状态的规模设计地过大</a>.  </p>
<p>我希望这个教程保持简单, 因此不想花费太多时间在安装和配置 Redux 上, 所以在状态管理方面, 会采取尽量简洁的模式. 规模上不像 Redux 那么大 (我们的 App 也没有到必须使用 Redux 来管理状态的地步). 目前我还没有为我的状态管理工具设计好 API, 不过我已经想好了它的名字:  <code class="language-text">Game</code> , 这个工具所必需的一点功能是: 将数据变化的消息通知给我们的 React 代码.</p>
<p>既然有了规划, 我要开始实现我的代码了: <code class="language-text">index.js</code> , 在代码中我会假设 <code class="language-text">Game</code> 的功能已经实现完成. 要注意我们目前的代码还不能够正常执行. 因为我还没想好如何设计我的 API:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">import</span> Board <span class="token keyword">from</span> <span class="token string">'./Board'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> observe <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Game'</span>

<span class="token keyword">const</span> root <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span>

<span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">knightPosition</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Board</span></span> <span class="token attr-name">knightPosition</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>knightPosition<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">,</span> root<span class="token punctuation">)</span>
<span class="token punctuation">)</span></code></pre></div>
<p>我引入的 <code class="language-text">observe</code> 函数是什么呢? 之前提到过我们要实时获取变化的状态, 这个函数能帮助我们达到目的. 我也可以实现一个 <code class="language-text">EventEmitter</code> 来达到同样的目的, 但是这有点大材小用了, 现在我只需要实时关注单个事件的变化, 完全没必要用到 <code class="language-text">EventEmitter</code> . 同时, 我还能将 <code class="language-text">Game</code> 构造为一个对象模型, 可这也是没有必要的, 因为简单的数据类型就能满足我们的需求. </p>
<p>为了验证订阅的 API 是有效的, 我会先实现一个假的状态管理模块 <code class="language-text">Game</code> , 它会随意生成不同的位置:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">observe</span><span class="token punctuation">(</span><span class="token parameter">receive</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">randPos</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span>
  <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">receive</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">randPos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">randPos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>现在终于可以回到我们的游戏本身了!</p>
<p><img src="/blog/7e015fe4a8f02535b507404c7081d6ef/Screen20Recording202015-05-1520at2012.0620pm.gif" alt="Screen20Recording202015-05-1520at2012.0620pm.gif"></p>
<p>目前达到的效果还不是特别理想. 接下来我希望实现一些联动, 因此需要找到一种方式, 在组件内部修改 <code class="language-text">Game</code> 中所存储的状态. 目前, 我依然希望保持尽可能简单, 因此暴露了 <code class="language-text">moveKnight</code> 方法, 以直接修改内部的状态. 在较为复杂的 app 中, 不同的状态可能会根据不同的用户行为有不同的变化, 因此我们的方式并不适合复杂场景. 但是在我们目前的场景下, 这种方式还是能够满足正常的需求的.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">let</span> knightPosition <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> observer <span class="token operator">=</span> <span class="token keyword">null</span>

<span class="token keyword">function</span> <span class="token function">emitChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">observer</span><span class="token punctuation">(</span>knightPosition<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">observe</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>observer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Multiple observers not implemented.'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  observer <span class="token operator">=</span> o
  <span class="token function">emitChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">moveKnight</span><span class="token punctuation">(</span><span class="token parameter">toX<span class="token punctuation">,</span> toY</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  knightPosition <span class="token operator">=</span> <span class="token punctuation">[</span>toX<span class="token punctuation">,</span> toY<span class="token punctuation">]</span>
  <span class="token function">emitChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>现在开始回到我们的组件. 目前我们的目标是, 当某个棋盘格被点击, 将骑士引导到该棋盘格. 一种方式是在棋盘格(<code class="language-text">Square</code>)组件本身调用 <code class="language-text">moveKnight</code> 方法. 不过这就需要我们在调用方法时传入棋盘格当前的位置. 这边有个较为合理的指导方针:  </p>
<blockquote>
<p>如果一个组件的渲染不需要某些数据, 那么在任何情况下, 该组件都不需要那些数据.</p>
</blockquote>
<p><code class="language-text">Square</code> 组件在渲染时候并不需要知道它的位置信息. 因此我们应该尽量避免将 <code class="language-text">moveRight</code> 方法与 <code class="language-text">Square</code> 组件耦合. 于是我们现在把 <code class="language-text">onClick</code> 处理函数添加给 <code class="language-text">div</code>, 它包裹着 <code class="language-text">Square</code> , 被 <code class="language-text">Board</code> 包裹:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> Square <span class="token keyword">from</span> <span class="token string">'./Square'</span>
<span class="token keyword">import</span> Knight <span class="token keyword">from</span> <span class="token string">'./Knight'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> moveKnight <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Game'</span>

<span class="token comment">/* ... */</span>

<span class="token keyword">function</span> <span class="token function">renderSquare</span><span class="token punctuation">(</span><span class="token parameter">i<span class="token punctuation">,</span> knightPosition</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">handleSquareClick</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">handleSquareClick</span><span class="token punctuation">(</span><span class="token parameter">toX<span class="token punctuation">,</span> toY</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">moveKnight</span><span class="token punctuation">(</span>toX<span class="token punctuation">,</span> toY<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>实际上, <code class="language-text">onClick</code> 属性还可以添加到 <code class="language-text">Square</code> 组件中, 不过我们最终还是会将点击事件处理器移除, 然后添加上拖拽处理器的, 所以没有必要这样做了.</p>
<p>截止目前, 我们剩下的只有走棋规则的校验了. 骑士不允许任意走到某个棋盘格, <a href="https://en.wikipedia.org/wiki/Knight_%28chess%29#Movement">走L字</a>是国际象棋的标准规范. 于是我现在开始在 <code class="language-text">Game</code> 中实现 <code class="language-text">canMoveKnight(toX, toY)</code> 方法, 并将初始位置设置为 A2, 以满足国际象棋的规则:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">let</span> knightPosition <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span>

<span class="token comment">/* ... */</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">canMoveKnight</span><span class="token punctuation">(</span><span class="token parameter">toX<span class="token punctuation">,</span> toY</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> knightPosition
  <span class="token keyword">const</span> dx <span class="token operator">=</span> toX <span class="token operator">-</span> x
  <span class="token keyword">const</span> dy <span class="token operator">=</span> toY <span class="token operator">-</span> y

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>dx<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>dy<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">||</span>
    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>dx<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>dy<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>最终, 我在 <code class="language-text">handleSquareClick</code> 方法中, 添加了校验方法:<code class="language-text">canMoveKnight</code> :</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> canMoveKnight<span class="token punctuation">,</span> moveKnight <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Game'</span>

<span class="token comment">/* ... */</span>

<span class="token keyword">function</span> <span class="token function">handleSquareClick</span><span class="token punctuation">(</span><span class="token parameter">toX<span class="token punctuation">,</span> toY</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">canMoveKnight</span><span class="token punctuation">(</span>toX<span class="token punctuation">,</span> toY<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">moveKnight</span><span class="token punctuation">(</span>toX<span class="token punctuation">,</span> toY<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p><img src="/blog/20ab36582e89f73641a3b1a183a8da86/Screen20Recording202015-05-1520at2012.0820pm.gif" alt="Screen20Recording202015-05-1520at2012.0820pm.gif"></p>
<p>很不错.</p>
<p>实际上, 接下来的这一部分是让我想要编写这份教程的原因. 我们要开始正式进入 React DnD  的世界了, 将拖拽交互与我们的 React 组件进行整合. </p>
<p>这部分内容假设你已经对<a href="https://react-dnd.github.io/react-dnd/docs/overview">概览</a>中的内容已经有了初步的了解, 比如说: 底层, 收集函数, 类型, 项目, 拖拽元素, 以及拖拽目标等概念. 如果你对以上概念一无所知, 暂时没有关系, 但是要确保你在代码实现阶段对它们有所了解.</p>
<p>现在我们开始安装 React DnD 和底层的 HTML5 依赖:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> react-dnd react-dnd-html5-backend</code></pre></div>
<p>将来你可能会想要使用其他第三方的底层依赖, 例如: <a href="https://www.npmjs.com/package/react-dnd-touch-backend">touch backend</a>. 不过这部分内容和我们的教程没有太大关系, 就不深入了.</p>
<h2 id="设置拖拽上下文" style="position:relative;"><a href="#%E8%AE%BE%E7%BD%AE%E6%8B%96%E6%8B%BD%E4%B8%8A%E4%B8%8B%E6%96%87" aria-label="设置拖拽上下文 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>设置拖拽上下文</h2>
<p>首先需要在我们的 app 中设置 <code class="language-text">[DndProvider](https://react-dnd.github.io/react-dnd/docs/api/dnd-provider)</code> . 它需要包裹在我们组件的最外层. 同时底层依赖也是在此声明的, 本教程中我们使用的是<a href="https://react-dnd.github.io/react-dnd/docs/backends/html5">HTML5Backend</a>.</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> DndProvider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-dnd'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> HTML5Backend <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-dnd-html5-backend'</span>

<span class="token keyword">function</span> <span class="token function">Board</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... */</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">DndProvider</span></span> <span class="token attr-name">backend</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>HTML5Backend<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">DndProvider</span></span><span class="token punctuation">></span></span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="定义拖拽类型" style="position:relative;"><a href="#%E5%AE%9A%E4%B9%89%E6%8B%96%E6%8B%BD%E7%B1%BB%E5%9E%8B" aria-label="定义拖拽类型 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>定义拖拽类型</h2>
<p>接下来要创建一个拖拽类型用以描述可拖拽的项目. 在我们目前的 app 中, 只存在一个拖拽类型, 也就是 <code class="language-text">KNIGHT</code> . 我将会创建一个模块 <code class="language-text">Constants</code> , 输出该类型:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">export</span> <span class="token keyword">const</span> ItemTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">KNIGHT</span><span class="token operator">:</span> <span class="token string">'knight'</span>
<span class="token punctuation">}</span></code></pre></div>
<p>准备工作已经做好了. 现在开始实现 <code class="language-text">Knight</code> 组件的拖拽功能!</p>
<h2 id="实现骑士的可拖拽" style="position:relative;"><a href="#%E5%AE%9E%E7%8E%B0%E9%AA%91%E5%A3%AB%E7%9A%84%E5%8F%AF%E6%8B%96%E6%8B%BD" aria-label="实现骑士的可拖拽 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>实现骑士的可拖拽</h2>
<p><code class="language-text">[useDrag](https://react-dnd.github.io/react-dnd/docs/api/use-drag)</code> 钩子函数接受一个有明确结构的对象. 该对象中, <code class="language-text">item.type</code> 的值就是我们刚刚声明的拖拽类型, 然后我们开始实现收集函数.</p>
<p>首先分解步骤:</p>
<ul>
<li><code class="language-text">useDrag</code> 接受有明确结构的对象. <code class="language-text">item.type</code> 是必需的属性, 它声明了可拖拽项目的类型. 这里还可以添加其他信息来完善可拖拽元素的信息. 但是由于我们创建的应用只是教程作用, 因此不再设置其他复杂的属性.</li>
<li><code class="language-text">collect</code> 属性表示 <em>收集函数</em> : 基本上来说, React DnD 是通过这个方法将拖拽系统中组件的状态信息转换成组件可用的属性的.</li>
<li>
<p><code class="language-text">result array</code> 包含的内容</p>
<ul>
<li><code class="language-text">props</code> 对象是这个数组的第一项, 其中包含了用户可以从拖拽系统中获取到的所有属性.</li>
<li><em>ref</em> 函数是数组的第二项. 它用以关联 DOM 元素和 react-dnd.</li>
</ul>
</li>
</ul>
<p>现在我们来看看 <code class="language-text">Knight</code> 组件具体是怎样的, 包括 <code class="language-text">useDrag</code> 函数和 <code class="language-text">render</code> 函数:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ItemTypes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Constants'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useDrag <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-dnd'</span>

<span class="token keyword">function</span> <span class="token function">Knight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>isDragging<span class="token punctuation">}</span><span class="token punctuation">,</span> drag<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useDrag</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    item<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> ItemTypes<span class="token punctuation">.</span><span class="token constant">KNIGHT</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">collect</span><span class="token operator">:</span> <span class="token parameter">monitor</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      isDragging<span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>monitor<span class="token punctuation">.</span><span class="token function">isDragging</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>drag<span class="token punctuation">}</span></span>
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        opacity<span class="token operator">:</span> isDragging <span class="token operator">?</span> <span class="token number">0.5</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        fontSize<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
        fontWeight<span class="token operator">:</span> <span class="token string">'bold'</span><span class="token punctuation">,</span>
        cursor<span class="token operator">:</span> <span class="token string">'move'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">></span></span><span class="token plain-text">
      ♘
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Knight</code></pre></div>
<p><img src="/blog/f84c48ab83741295631f1a5b1c4b5e89/Screen20Recording202015-05-1520at2001.1120pm.gif" alt="Screen20Recording202015-05-1520at2001.1120pm.gif"></p>
<p><code class="language-text">Knight</code> 现在已经是一个拖拽元素了, 但是目前还没有拖拽目标区域来接受这个元素. 于是我们开始将 <code class="language-text">Square</code> 声明为拖拽目标区域.</p>
<p>不过这次我必须将位置信息传入 <code class="language-text">Square</code> 组件了. 毕竟如果 <code class="language-text">Square</code> 组件不知道自己自己所在的位置, 它就无法知道应该将骑士拖拽到哪个区域. 另一方面,  it still feels wrong because the <code class="language-text">Square</code> as an entity in our application has not changed, and if it used to be simple, why complicate it? When you face this dilemma, it’s time to separate the <a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0">smart and dumb components</a>.</p>
<p>接下来我要开始添加一个新的组件 <code class="language-text">BoardSquare</code>.  实际上它渲染的是之前的 <code class="language-text">Square</code> ,不过 <code class="language-text">BoardSquare</code> 知道它的位置信息. 同时这个组件还封装了一些逻辑, 这些逻辑在旧的组件 <code class="language-text">Board</code> 中是 <code class="language-text">renderSquare</code> 所作的事情.  这里有一点要注意, 当你用 <code class="language-text">renderXXX</code> 来在某个组件中实现另一个组件时, 就要将 <code class="language-text">renderXXX</code> 中的内容拆分为另一个组件了.</p>
<p>以下是我提取出来的 <code class="language-text">BoardSquare</code> 组件:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> Square <span class="token keyword">from</span> <span class="token string">'./Square'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">BoardSquare</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> black <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> y<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">1</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Square</span></span> <span class="token attr-name">black</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>black<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Square</span></span><span class="token punctuation">></span></span>
<span class="token punctuation">}</span></code></pre></div>
<p>I also changed the <code class="language-text">Board</code> to use it:</p>
<p>我还对 <code class="language-text">Board</code> 组件做了一些小改动:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">/* ... */</span>
<span class="token keyword">import</span> BoardSquare <span class="token keyword">from</span> <span class="token string">'./BoardSquare'</span>

<span class="token keyword">function</span> <span class="token function">renderSquare</span><span class="token punctuation">(</span><span class="token parameter">i<span class="token punctuation">,</span> knightPosition</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> x <span class="token operator">=</span> i <span class="token operator">%</span> <span class="token number">8</span>
  <span class="token keyword">const</span> y <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>i <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> width<span class="token operator">:</span> <span class="token string">'12.5%'</span><span class="token punctuation">,</span> height<span class="token operator">:</span> <span class="token string">'12.5%'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">BoardSquare</span></span> <span class="token attr-name">x</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>x<span class="token punctuation">}</span></span> <span class="token attr-name">y</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>y<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token function">renderPiece</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> knightPosition<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">BoardSquare</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">renderPiece</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token punctuation">[</span>knightX<span class="token punctuation">,</span> knightY<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">===</span> knightX <span class="token operator">&amp;&amp;</span> y <span class="token operator">===</span> knightY<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Knight</span></span> <span class="token punctuation">/></span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>现在我们用 <code class="language-text">[useDrop](https://react-dnd.github.io/react-dnd/docs/api/use-drop)</code> 钩子函数来将 <code class="language-text">BoardSquare</code> 组件包装起来. 在该钩子函数中, 我会声明一些可拖拽目标的属性用于处理拖拽事件:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> drop<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useDrop</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  accept<span class="token operator">:</span> ItemTypes<span class="token punctuation">.</span><span class="token constant">KNIGHT</span><span class="token punctuation">,</span>
  <span class="token function-variable function">drop</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">moveKnight</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>看到了吗? 在 <code class="language-text">drop</code> 方法中还接受到了 <code class="language-text">BoardSquare</code> 获取的属性, 因此 <code class="language-text">drop</code> 方法知道落棋时骑士应该处于哪个位置. 在实际的 app 中, 我还会用 <code class="language-text">monitor.getItem()</code> 方法来获取被拖拽项目的相关信息 (信息由 <code class="language-text">beginDrag</code> 方法中的拖拽元素返回). 不过目前我们只有一个拖拽元素, 不太需要该方法.</p>
<p>在我的收集器函数中, 会通过监视器函数关注当前处于棋盘格的哪一部分, 以便对棋盘格添加高亮. </p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> isOver <span class="token punctuation">}</span><span class="token punctuation">,</span> drop<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useDrop</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  accept<span class="token operator">:</span> ItemTypes<span class="token punctuation">.</span><span class="token constant">KNIGHT</span><span class="token punctuation">,</span>
  <span class="token function-variable function">drop</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">moveKnight</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">collect</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">monitor</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    isOver<span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>monitor<span class="token punctuation">.</span><span class="token function">isOver</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>修改 <code class="language-text">render</code> 函数关联可拖拽目标, 并添加高亮之后, 我们的 <code class="language-text">BoardSquare</code> 变成了这样:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> Square <span class="token keyword">from</span> <span class="token string">'./Square'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> canMoveKnight<span class="token punctuation">,</span> moveKnight <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Game'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ItemTypes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Constants'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useDrop <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-dnd'</span>

<span class="token keyword">function</span> <span class="token function">BoardSquare</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> black <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> y<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">1</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> isOver <span class="token punctuation">}</span><span class="token punctuation">,</span> drop<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useDrop</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    accept<span class="token operator">:</span> ItemTypes<span class="token punctuation">.</span><span class="token constant">KNIGHT</span><span class="token punctuation">,</span>
    <span class="token function-variable function">drop</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">moveKnight</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">collect</span><span class="token operator">:</span> <span class="token parameter">monitor</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      isOver<span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>monitor<span class="token punctuation">.</span><span class="token function">isOver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>drop<span class="token punctuation">}</span></span>
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        position<span class="token operator">:</span> <span class="token string">'relative'</span><span class="token punctuation">,</span>
        width<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
        height<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Square</span></span> <span class="token attr-name">black</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>black<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Square</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>isOver <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
          <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
            position<span class="token operator">:</span> <span class="token string">'absolute'</span><span class="token punctuation">,</span>
            top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            height<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
            width<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
            zIndex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            opacity<span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
            backgroundColor<span class="token operator">:</span> <span class="token string">'yellow'</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
        <span class="token punctuation">/></span></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> BoardSquare</code></pre></div>
<p><img src="/blog/a4b7e4c5ca489a26914f4a690ea76885/Screen20Recording202015-05-1520at2001.5520pm.gif" alt="Screen20Recording202015-05-1520at2001.5520pm.gif"></p>
<p>我们的 App 看起来功能已经比较完善了! 接下来还有最后一步. 如果棋子被拖拽到不符合要求的区域, 棋盘格要被高亮为红色, 并且不可将骑士放置于该区域. </p>
<p>通过 React DnD 可以很简单地实现我们的目的, 只需要在拖拽区域的属性中定义 <code class="language-text">canDrop</code> 方法即可:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> isOver<span class="token punctuation">,</span> canDrop <span class="token punctuation">}</span><span class="token punctuation">,</span> drop<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useDrop</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  accept<span class="token operator">:</span> ItemTypes<span class="token punctuation">.</span><span class="token constant">KNIGHT</span><span class="token punctuation">,</span>
  <span class="token function-variable function">canDrop</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">canMoveKnight</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">drop</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">moveKnight</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">collect</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">monitor</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    isOver<span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>monitor<span class="token punctuation">.</span><span class="token function">isOver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    canDrop<span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>monitor<span class="token punctuation">.</span><span class="token function">canDrop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>同时, 在收集器函数中我们再添加 <code class="language-text">monitor.canDrop()</code> 方法, 用以标识区域是否可接受拖拽元素:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> Square <span class="token keyword">from</span> <span class="token string">'./Square'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> canMoveKnight<span class="token punctuation">,</span> moveKnight <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Game'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ItemTypes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Constants'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useDrop <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-dnd'</span>

<span class="token keyword">function</span> <span class="token function">BoardSquare</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> black <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> y<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">1</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> isOver<span class="token punctuation">,</span> canDrop <span class="token punctuation">}</span><span class="token punctuation">,</span> drop<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useDrop</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    accept<span class="token operator">:</span> ItemTypes<span class="token punctuation">.</span><span class="token constant">KNIGHT</span><span class="token punctuation">,</span>
    <span class="token function-variable function">drop</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">moveKnight</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">canDrop</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">canMoveKnight</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">collect</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">monitor</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      isOver<span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>monitor<span class="token punctuation">.</span><span class="token function">isOver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      canDrop<span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>monitor<span class="token punctuation">.</span><span class="token function">canDrop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>drop<span class="token punctuation">}</span></span>
      <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        position<span class="token operator">:</span> <span class="token string">'relative'</span><span class="token punctuation">,</span>
        width<span class="token operator">:</span> <span class="token string">'100%'</span><span class="token punctuation">,</span>
        height<span class="token operator">:</span> <span class="token string">'100%'</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Square</span></span> <span class="token attr-name">black</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>black<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Square</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>isOver <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>canDrop <span class="token operator">&amp;&amp;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Overlay</span></span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>red<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token operator">!</span>isOver <span class="token operator">&amp;&amp;</span> canDrop <span class="token operator">&amp;&amp;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Overlay</span></span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>yellow<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token punctuation">{</span>isOver <span class="token operator">&amp;&amp;</span> canDrop <span class="token operator">&amp;&amp;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Overlay</span></span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>green<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> BoardSquare</code></pre></div>
<p><img src="/blog/614dd627b795d39ec9d99d24149a0ebc/Screen20Recording202015-05-1520at2002.0520pm.gif" alt="Screen20Recording202015-05-1520at2002.0520pm.gif"></p>
<h2 id="添加拖拽预览图" style="position:relative;"><a href="#%E6%B7%BB%E5%8A%A0%E6%8B%96%E6%8B%BD%E9%A2%84%E8%A7%88%E5%9B%BE" aria-label="添加拖拽预览图 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>添加拖拽预览图</h2>
<p>最后一步就是在骑士被拖拽到某个棋盘格之上时, 展示预览图. 尽管浏览器可以对 DOM 节点处理截取屏幕快照. 不过我们希望设置自定义的图片, 应该怎么办呢?</p>
<p>React DnD 内部同样提供了一种方法以实现上述需求, 只需要使用 <code class="language-text">useDrag</code> 钩子函数提供的 preview <code class="language-text">ref</code> 既可:</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> isDragging <span class="token punctuation">}</span><span class="token punctuation">,</span> drag<span class="token punctuation">,</span> preview<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useDrag</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  item<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> ItemTypes<span class="token punctuation">.</span><span class="token constant">KNIGHT</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">collect</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">monitor</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    isDragging<span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>monitor<span class="token punctuation">.</span><span class="token function">isDragging</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>通过这个属性关联 <code class="language-text">render</code> 方法中的 <code class="language-text">dragPreview</code>, 就能达到目的. 同时 <code class="language-text">react-dnd</code> 还提供了一个工具组件 <code class="language-text">DragPreviewImage</code> 以展示预览图.</p>
<p>本教程通过创建一些 React 组件, 提供组件功能, 状态设计的建议, 然后整合 React  DnD 的拖拽功能, 以达到教学的目的. 教程的目标是传达这两个信息: React DnD 的设计哲学与 React 可以配合得十分默契; 还有一点是, 在实现某些复杂交互之前, 要首先思考 app 的整体结构.</p>
<p>接下来开始享受 DnD 给你带来的拖拽体验吧.</p>
<p>来玩一玩我们的<a href="https://react-dnd.github.io/react-dnd/examples/tutorial">简易象棋游戏</a>!</p></section><hr/><footer><div class="bio"><div data-gatsby-image-wrapper="" style="width:50px;height:50px" class="gatsby-image-wrapper bio-avatar"><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;width:50px;height:50px;position:relative"></div><picture><source type="image/avif" data-srcset="/blog/static/0d1ae485b869926285547d68f24089ad/d4bf4/photo.avif 50w,/blog/static/0d1ae485b869926285547d68f24089ad/ee81f/photo.avif 100w" sizes="50px"/><source type="image/webp" data-srcset="/blog/static/0d1ae485b869926285547d68f24089ad/3faea/photo.webp 50w,/blog/static/0d1ae485b869926285547d68f24089ad/6a679/photo.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" data-src="/blog/static/0d1ae485b869926285547d68f24089ad/d24ee/photo.jpg" data-srcset="/blog/static/0d1ae485b869926285547d68f24089ad/d24ee/photo.jpg 50w,/blog/static/0d1ae485b869926285547d68f24089ad/64618/photo.jpg 100w" alt="Profile picture"/></picture><noscript><picture><source type="image/avif" srcSet="/blog/static/0d1ae485b869926285547d68f24089ad/d4bf4/photo.avif 50w,/blog/static/0d1ae485b869926285547d68f24089ad/ee81f/photo.avif 100w" sizes="50px"/><source type="image/webp" srcSet="/blog/static/0d1ae485b869926285547d68f24089ad/3faea/photo.webp 50w,/blog/static/0d1ae485b869926285547d68f24089ad/6a679/photo.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" src="/blog/static/0d1ae485b869926285547d68f24089ad/d24ee/photo.jpg" srcSet="/blog/static/0d1ae485b869926285547d68f24089ad/d24ee/photo.jpg 50w,/blog/static/0d1ae485b869926285547d68f24089ad/64618/photo.jpg 100w" alt="Profile picture"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div></div></footer></article><nav class="blog-post-nav"><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/blog/react-dnd-overview/">← <!-- -->React DnD 文档翻译 - 概览</a></li><li></li></ul></nav></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/react-dnd-tutorial/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-56e919f1fc9a731e5927.js"],"app":["/app-8cc590526fc91995e11e.js"],"component---src-pages-404-js":["/component---src-pages-404-js-02dee739284fbee12e4e.js"],"component---src-pages-draft-js":["/component---src-pages-draft-js-193d4caecfae2a634e2b.js"],"component---src-pages-index-js":["/component---src-pages-index-js-8d06a138a82d686eac0f.js"],"component---src-pages-using-typescript-tsx":["/component---src-pages-using-typescript-tsx-ed6fa9d078c752cee965.js"],"component---src-templates-blog-js":["/component---src-templates-blog-js-40e0ec0461a2aa11ea07.js"]};/*]]>*/</script><script src="/blog/polyfill-56e919f1fc9a731e5927.js" nomodule=""></script><script src="/blog/component---src-templates-blog-js-40e0ec0461a2aa11ea07.js" async=""></script><script src="/blog/commons-ff66217271001e5b3970.js" async=""></script><script src="/blog/app-8cc590526fc91995e11e.js" async=""></script><script src="/blog/framework-b2b1b62bddbed1246653.js" async=""></script><script src="/blog/webpack-runtime-1c10d4462d6abdb81356.js" async=""></script></body></html>